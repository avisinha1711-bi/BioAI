<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GenefloAI Genetic Translator</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        
        :root {
            --primary: #2563eb;
            --primary-light: #3b82f6;
            --primary-dark: #1d4ed8;
            --secondary: #7c3aed;
            --accent: #06b6d4;
            --bg-dark: #0a0f1a;
            --bg-card: #1a2235;
            --text-light: #f8fafc;
            --text-lighter: #cbd5e1;
            --text-muted: #94a3b8;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --border: #2d3748;
        }
        
        body {
            background-color: var(--bg-dark);
            color: var(--text-light);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }
        
        /* Network lines background - Increased visibility */
        .network-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.08; /* Increased from 0.03 */
        }
        
        .network-dot {
            position: absolute;
            width: 3px; /* Increased from 2px */
            height: 3px; /* Increased from 2px */
            background: white;
            border-radius: 50%;
        }
        
        .network-line {
            position: absolute;
            background: white;
            height: 1px;
            transform-origin: left center;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }
        
        header {
            text-align: center;
            padding: 40px 0 30px;
            color: white;
            position: relative;
        }
        
        header h1 {
            font-size: 2.8rem;
            margin-bottom: 12px;
            color: var(--text-light);
            font-weight: 700;
            letter-spacing: -0.5px;
        }
        
        header p {
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
            color: var(--text-muted);
            font-weight: 400;
        }
        
        .card {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            transition: all 0.3s ease;
            border: 1px solid var(--border);
            position: relative;
            overflow: hidden;
        }
        
        .card:hover {
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
        }
        
        .input-section {
            display: flex;
            flex-direction: column;
        }
        
        .input-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        label {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--text-lighter);
            font-size: 1.1rem;
        }
        
        .sequence-counter {
            background: rgba(37, 99, 235, 0.1);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            color: var(--primary-light);
            font-weight: 500;
        }
        
        .input-group {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        input {
            flex: 1;
            padding: 16px 20px;
            background: rgba(26, 34, 53, 0.7);
            border: 1px solid var(--border);
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
            color: var(--text-light);
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
        }
        
        input:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        
        .input-actions {
            display: flex;
            gap: 12px;
        }
        
        button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 14px 24px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        button:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }
        
        button.secondary {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-lighter);
        }
        
        button.secondary:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--primary-light);
        }
        
        .complementary-preview {
            background: rgba(26, 34, 53, 0.7);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 4px solid var(--primary);
            display: none;
            animation: fadeIn 0.5s ease;
            position: relative;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .complementary-preview.show {
            display: block;
        }
        
        .complementary-preview-title {
            font-weight: 600;
            color: var(--text-lighter);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
        }
        
        .complementary-preview-content {
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
            background: rgba(45, 55, 72, 0.5);
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 1rem;
            color: var(--text-light);
            border: 1px solid var(--border);
        }
        
        .results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }
        
        .result-box {
            background: rgba(26, 34, 53, 0.7);
            padding: 25px;
            border-radius: 12px;
            border-left: 4px solid var(--primary);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            border: 1px solid var(--border);
        }
        
        .result-box:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .result-title {
            font-weight: 600;
            color: var(--text-lighter);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1rem;
        }
        
        .result-content {
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
            background: rgba(45, 55, 72, 0.5);
            padding: 18px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 1rem;
            color: var(--text-light);
            min-height: 60px;
            display: flex;
            align-items: center;
            border: 1px solid var(--border);
        }
        
        .visualization {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 40px 0;
            padding: 30px;
            background: var(--bg-card);
            border-radius: 16px;
            border: 1px solid var(--border);
            position: relative;
        }
        
        .process-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            flex: 1;
        }
        
        .step-icon {
            width: 60px;
            height: 60px;
            background: rgba(37, 99, 235, 0.1);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            font-size: 1.5rem;
            color: var(--primary);
            border: 1px solid var(--border);
        }
        
        .step-label {
            font-weight: 600;
            color: var(--text-lighter);
            margin-bottom: 10px;
            font-size: 0.9rem;
        }
        
        .dna-strand {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            min-height: 150px;
            justify-content: center;
        }
        
        .base {
            width: 35px;
            height: 35px;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 8px;
            font-weight: 600;
            color: white;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .base:hover {
            transform: scale(1.05);
        }
        
        .a { background: #ef4444; }
        .t { background: #10b981; }
        .c { background: #f59e0b; color: #1e293b; }
        .g { background: #3b82f6; }
        .u { background: #8b5cf6; }
        
        .bond {
            width: 2px;
            height: 18px;
            background: var(--primary);
            opacity: 0.4;
        }
        
        .arrow {
            font-size: 1.5rem;
            color: var(--primary);
            margin: 0 15px;
            opacity: 0.7;
        }
        
        .protein-info {
            margin-top: 10px;
            font-size: 0.8rem;
            color: var(--text-muted);
            background: rgba(37, 99, 235, 0.1);
            padding: 5px 10px;
            border-radius: 10px;
        }
        
        .info-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px;
            margin-top: 40px;
        }
        
        .info-card {
            background: var(--bg-card);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid var(--border);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .info-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .info-card h3 {
            color: var(--text-lighter);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.2rem;
        }
        
        .info-card ul {
            list-style: none;
        }
        
        .info-card li {
            margin-bottom: 12px;
            padding-left: 30px;
            position: relative;
            color: var(--text-muted);
        }
        
        .info-card li:before {
            content: "•";
            color: var(--primary);
            font-weight: bold;
            position: absolute;
            left: 15px;
            font-size: 1.2rem;
        }
        
        footer {
            text-align: center;
            margin-top: 60px;
            color: var(--text-muted);
            padding: 30px;
            opacity: 0.8;
            border-top: 1px solid var(--border);
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .input-group {
                flex-direction: column;
            }
            
            .input-actions {
                width: 100%;
            }
            
            .input-actions button {
                flex: 1;
            }
            
            .visualization {
                flex-direction: column;
                gap: 30px;
                padding: 20px;
            }
            
            .arrow {
                transform: rotate(90deg);
                margin: 10px 0;
            }
            
            header h1 {
                font-size: 2.2rem;
            }
            
            .process-step {
                width: 100%;
            }
            
            .dna-strand {
                flex-direction: row;
                min-height: auto;
                gap: 10px;
            }
            
            .bond {
                width: 15px;
                height: 2px;
            }
        }
        
        .highlight {
            background: rgba(245, 158, 11, 0.1);
            padding: 3px 6px;
            border-radius: 4px;
            color: #f59e0b;
        }
        
        .stop-codon {
            background: #ef4444;
            color: white;
            padding: 3px 6px;
            border-radius: 4px;
        }
        
        .start-codon {
            background: #10b981;
            padding: 3px 6px;
            border-radius: 4px;
            color: white;
        }
        
        .molecular-weight {
            margin-top: 15px;
            padding: 12px;
            background: rgba(37, 99, 235, 0.1);
            border-radius: 8px;
            font-weight: 600;
            color: var(--text-lighter);
            border-left: 3px solid var(--primary);
        }
        
        .placeholder {
            color: var(--text-muted);
            font-style: italic;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 10px;
            color: white;
            font-weight: 600;
            z-index: 1000;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transform: translateX(150%);
            transition: transform 0.4s ease;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.success {
            background: var(--success);
        }
        
        .notification.error {
            background: var(--error);
        }
        
        .loading {
            display: inline-block;
            width: 18px;
            height: 18px;
            border: 2px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* New styles for strand selection */
        .strand-selection {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .strand-options {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .strand-option {
            flex: 1;
            min-width: 200px;
        }
        
        .strand-option label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-lighter);
        }
        
        select {
            width: 100%;
            padding: 14px 16px;
            background: rgba(26, 34, 53, 0.7);
            border: 1px solid var(--border);
            border-radius: 10px;
            font-size: 16px;
            color: var(--text-light);
            transition: all 0.3s;
        }
        
        select:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        
        .strand-info {
            background: rgba(37, 99, 235, 0.1);
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid var(--primary);
            margin-top: 10px;
            font-size: 0.9rem;
            color: var(--text-lighter);
        }
        
        .strand-info.hidden {
            display: none;
        }

        /* Chatbot Styles - Improved with workflow and interactive mode */
        .chatbot-container {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 100;
        }

        .chatbot-toggle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            transition: all 0.3s;
        }

        .chatbot-toggle:hover {
            background: var(--primary-dark);
            transform: scale(1.05);
        }

        .chatbot-window {
            position: absolute;
            bottom: 80px;
            right: 0;
            width: 420px;
            height: 580px;
            background: var(--bg-card);
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            border: 1px solid var(--border);
            transform: scale(0);
            transform-origin: bottom right;
            transition: transform 0.3s;
            max-height: calc(100vh - 150px);
            max-width: calc(100vw - 60px);
        }

        .chatbot-window.active {
            transform: scale(1);
        }

        .chatbot-header {
            padding: 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chatbot-header h3 {
            color: var(--text-lighter);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chatbot-close {
            background: none;
            border: none;
            color: var(--text-muted);
            font-size: 1.2rem;
            cursor: pointer;
            padding: 5px;
        }

        .chatbot-close:hover {
            color: var(--text-light);
        }

        .chatbot-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 12px;
            line-height: 1.4;
        }

        .message.user {
            align-self: flex-end;
            background: var(--primary);
            color: white;
            border-bottom-right-radius: 4px;
        }

        .message.bot {
            align-self: flex-start;
            background: rgba(26, 34, 53, 0.7);
            color: var(--text-light);
            border: 1px solid var(--border);
            border-bottom-left-radius: 4px;
        }

        .chatbot-input {
            padding: 20px;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 10px;
        }

        .chatbot-input input {
            flex: 1;
            padding: 12px 16px;
        }

        .chatbot-input button {
            padding: 12px 16px;
        }

        .suggested-questions {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }

        .suggested-question {
            background: rgba(37, 99, 235, 0.1);
            color: var(--primary-light);
            border: 1px solid var(--border);
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .suggested-question:hover {
            background: rgba(37, 99, 235, 0.2);
        }

        /* Workflow and Interactive Mode Styles */
        .workflow-controls {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .workflow-step {
            background: rgba(37, 99, 235, 0.15);
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .workflow-step:hover {
            background: rgba(37, 99, 235, 0.25);
        }

        .workflow-step.active {
            background: var(--primary);
            color: white;
        }

        .interactive-mode {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.3);
            padding: 12px;
            border-radius: 8px;
            margin-top: 10px;
        }

        .interactive-mode h4 {
            color: var(--success);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .interactive-options {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .interactive-option {
            background: rgba(16, 185, 129, 0.1);
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .interactive-option:hover {
            background: rgba(16, 185, 129, 0.2);
        }

        .workflow-progress {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 10px;
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .progress-bar {
            flex: 1;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--primary);
            transition: width 0.3s;
        }

        @media (max-width: 768px) {
            .chatbot-window {
                width: 90vw;
                right: 5vw;
            }
        }

        @media (max-height: 700px) {
            .chatbot-window {
                height: 450px;
            }
        }
    </style>
</head>
<body>
    <!-- Network lines background - More visible -->
    <div class="network-background" id="network-background"></div>
    
    <div class="container">
        <header>
            <h1>GenefloAI Genetic Translator</h1>
            <p>Translate DNA sequences to mRNA and polypeptide chains using advanced algorithms</p>
        </header>
        
        <!-- Strand Selection Card -->
        <div class="card">
            <div class="strand-selection">
                <div class="strand-options">
                    <div class="strand-option">
                        <label for="strand-type"><i class="fas fa-dna"></i> Strand Type</label>
                        <select id="strand-type">
                            <option value="template">Template Strand</option>
                            <option value="coding">Coding Strand</option>
                        </select>
                    </div>
                    
                    <div class="strand-option">
                        <label for="strand-direction"><i class="fas fa-arrows-alt-h"></i> Direction</label>
                        <select id="strand-direction">
                            <option value="3to5">3' → 5'</option>
                            <option value="5to3">5' → 3'</option>
                        </select>
                    </div>
                </div>
                
                <div class="strand-info" id="template-info">
                    <strong>Template Strand:</strong> Serves as the template for mRNA synthesis during transcription. 
                    The mRNA sequence is complementary to the template strand.
                </div>
                
                <div class="strand-info hidden" id="coding-info">
                    <strong>Coding Strand:</strong> Has the same sequence as the mRNA (with T instead of U). 
                    Also called the sense strand or non-template strand.
                </div>
            </div>
        </div>
        
        <!-- Main Input Card -->
        <div class="card">
            <div class="input-section">
                <div class="input-header">
                    <label for="dna-sequence" id="sequence-label">
                        <i class="fas fa-dna"></i> Enter DNA Sequence:
                    </label>
                    <div class="sequence-counter">
                        <span id="base-count">0</span> bases
                    </div>
                </div>
                
                <div class="input-group">
                    <input type="text" id="dna-sequence" placeholder="e.g., TACGAATTCTAGCATGAC">
                    <div class="input-actions">
                        <button id="translate-btn">
                            <i class="fas fa-code"></i> Translate
                        </button>
                        <button class="secondary" id="clear-btn">
                            <i class="fas fa-eraser"></i> Clear
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="results">
                <div class="result-box">
                    <div class="result-title">
                        <i class="fas fa-exchange-alt"></i> <span id="complementary-label">Coding Strand (5'→3')</span>
                    </div>
                    <div class="result-content" id="complementary-strand">-</div>
                </div>
                
                <div class="result-box">
                    <div class="result-title">
                        <i class="fas fa-rna"></i> mRNA Sequence (5'→3')
                    </div>
                    <div class="result-content" id="mrna-sequence">-</div>
                </div>
                
                <div class="result-box">
                    <div class="result-title">
                        <i class="fas fa-link"></i> Polypeptide Chain
                    </div>
                    <div class="result-content" id="polypeptide-chain">-</div>
                    <div class="molecular-weight" id="molecular-weight">Molecular Weight: -</div>
                </div>
            </div>
        </div>
        
        <div class="visualization">
            <div class="process-step">
                <div class="step-icon">
                    <i class="fas fa-dna"></i>
                </div>
                <div class="step-label">DNA Template</div>
                <div class="dna-strand" id="dna-visualization">
                    <div class="placeholder">Enter sequence</div>
                </div>
            </div>
            
            <div class="arrow">
                <i class="fas fa-arrow-right"></i>
            </div>
            
            <div class="process-step">
                <div class="step-icon">
                    <i class="fas fa-rna"></i>
                </div>
                <div class="step-label">mRNA</div>
                <div class="dna-strand" id="mrna-visualization">
                    <div class="placeholder">Transcription</div>
                </div>
            </div>
            
            <div class="arrow">
                <i class="fas fa-arrow-right"></i>
            </div>
            
            <div class="process-step">
                <div class="step-icon">
                    <i class="fas fa-link"></i>
                </div>
                <div class="step-label">Protein</div>
                <div class="dna-strand" id="protein-visualization">
                    <div class="placeholder">Translation</div>
                </div>
                <div class="protein-info" id="protein-info">Peptide length: 0</div>
            </div>
        </div>
        
        <div class="info-section">
            <div class="info-card">
                <h3><i class="fas fa-dna"></i> Genetic Code</h3>
                <ul>
                    <li><span class="highlight">Adenine (A)</span> pairs with <span class="highlight">Thymine (T)</span> in DNA</li>
                    <li><span class="highlight">Guanine (G)</span> pairs with <span class="highlight">Cytosine (C)</span> in DNA</li>
                    <li>In RNA, <span class="highlight">Thymine (T)</span> is replaced with <span class="highlight">Uracil (U)</span></li>
                    <li><span class="start-codon">AUG</span> is the start codon (Methionine)</li>
                    <li><span class="stop-codon">UAA, UAG, UGA</span> are stop codons</li>
                </ul>
            </div>
            
            <div class="info-card">
                <h3><i class="fas fa-flask"></i> Applications</h3>
                <ul>
                    <li>Genetic research and education</li>
                    <li>Protein synthesis simulation</li>
                    <li>Bioinformatics workflows</li>
                    <li>Molecular biology studies</li>
                    <li>AI-powered genetic analysis</li>
                </ul>
            </div>
            
            <div class="info-card">
                <h3><i class="fas fa-weight"></i> Molecular Weight Calculation</h3>
                <ul>
                    <li>Calculated for the polypeptide chain</li>
                    <li>Accounts for water loss in peptide bonds</li>
                    <li>Based on standard amino acid molecular weights</li>
                    <li>Displayed in Daltons (Da)</li>
                </ul>
            </div>
        </div>
        
        <footer>
            <p>GenefloAI Genetic Translator | Advanced DNA to Protein Conversion Tool</p>
            <p>© 2025 GenefloAI Research</p>
        </footer>
    </div>

    <!-- Enhanced Chatbot with Workflow and Interactive Mode -->
    <div class="chatbot-container">
        <div class="chatbot-toggle" id="chatbot-toggle">
            <i class="fas fa-robot"></i>
        </div>
        <div class="chatbot-window" id="chatbot-window">
            <div class="chatbot-header">
                <h3><i class="fas fa-robot"></i> MolGenoBot</h3>
                <button class="chatbot-close" id="chatbot-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="chatbot-messages" id="chatbot-messages">
                <div class="message bot">
                    Hello! I'm MolGenoBot, your molecular genetics assistant. I can help explain DNA structure, replication, transcription, translation, and more based on the latest research. What would you like to know?
                    <div class="suggested-questions">
                        <div class="suggested-question">DNA structure</div>
                        <div class="suggested-question">Transcription process</div>
                        <div class="suggested-question">Genetic code</div>
                        <div class="suggested-question">Lac operon</div>
                    </div>
                </div>
            </div>
            <div class="chatbot-input">
                <input type="text" id="chatbot-input" placeholder="Ask about molecular genetics...">
                <button id="chatbot-send"><i class="fas fa-paper-plane"></i></button>
            </div>
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <script>
        // Create network background with more visibility
        function createNetworkBackground() {
            const container = document.getElementById('network-background');
            const dots = [];
            const lines = [];
            
            // Create more dots for better visibility
            for (let i = 0; i < 60; i++) { // Increased from 40
                const dot = document.createElement('div');
                dot.className = 'network-dot';
                dot.style.left = `${Math.random() * 100}%`;
                dot.style.top = `${Math.random() * 100}%`;
                container.appendChild(dot);
                dots.push(dot);
            }
            
            // Create lines between nearby dots
            for (let i = 0; i < dots.length; i++) {
                for (let j = i + 1; j < dots.length; j++) {
                    const dot1 = dots[i];
                    const dot2 = dots[j];
                    
                    const x1 = parseFloat(dot1.style.left);
                    const y1 = parseFloat(dot1.style.top);
                    const x2 = parseFloat(dot2.style.left);
                    const y2 = parseFloat(dot2.style.top);
                    
                    const distance = Math.sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2);
                    
                    // Connect more dots for better visibility
                    if (distance < 25) { // Increased from 20
                        const line = document.createElement('div');
                        line.className = 'network-line';
                        
                        const length = distance;
                        const angle = Math.atan2(y2 - y1, x2 - x1) * 180 / Math.PI;
                        
                        line.style.width = `${length}%`;
                        line.style.left = `${x1}%`;
                        line.style.top = `${y1}%`;
                        line.style.transform = `rotate(${angle}deg)`;
                        
                        container.appendChild(line);
                        lines.push(line);
                    }
                }
            }
        }

        // Enhanced MolGenoBot functionality with Workflow and Interactive Mode
        function initializeChatbot() {
            const chatbotToggle = document.getElementById('chatbot-toggle');
            const chatbotWindow = document.getElementById('chatbot-window');
            const chatbotClose = document.getElementById('chatbot-close');
            const chatbotMessages = document.getElementById('chatbot-messages');
            const chatbotInput = document.getElementById('chatbot-input');
            const chatbotSend = document.getElementById('chatbot-send');
            
            // Workflow state
            let currentWorkflow = null;
            let workflowStep = 0;
            let workflowData = {};
            
            // Available workflows
            const workflows = {
                dnaReplication: {
                    name: "DNA Replication",
                    steps: [
                        "Initiation: Origin of replication",
                        "Unwinding: Helicase and SSB proteins",
                        "Primer synthesis: Primase activity",
                        "Elongation: DNA polymerase",
                        "Proofreading: Exonuclease activity",
                        "Ligation: DNA ligase"
                    ],
                    description: "Follow the step-by-step process of DNA replication"
                },
                proteinSynthesis: {
                    name: "Protein Synthesis",
                    steps: [
                        "Transcription: DNA to mRNA",
                        "RNA processing: Capping and splicing",
                        "mRNA export: Nucleus to cytoplasm",
                        "Translation: Ribosome assembly",
                        "Elongation: Polypeptide chain growth",
                        "Termination: Release factor binding"
                    ],
                    description: "Explore the complete protein synthesis pathway"
                },
                geneRegulation: {
                    name: "Gene Regulation",
                    steps: [
                        "Promoter recognition",
                        "Transcription factor binding",
                        "Chromatin remodeling",
                        "Transcription initiation",
                        "Elongation control",
                        "Termination regulation"
                    ],
                    description: "Understand how genes are regulated in cells"
                }
            };
            
            // Toggle chatbot window
            chatbotToggle.addEventListener('click', () => {
                chatbotWindow.classList.toggle('active');
            });
            
            // Close chatbot window
            chatbotClose.addEventListener('click', () => {
                chatbotWindow.classList.remove('active');
            });
            
            // Send message
            function sendMessage() {
                const message = chatbotInput.value.trim();
                if (!message) return;
                
                // Add user message
                addMessage(message, 'user');
                chatbotInput.value = '';
                
                // Show typing indicator
                const typingIndicator = document.createElement('div');
                typingIndicator.classList.add('message', 'bot');
                typingIndicator.innerHTML = '<div class="loading" style="display:inline-block; margin-right:10px;"></div> Thinking...';
                chatbotMessages.appendChild(typingIndicator);
                chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
                
                // Generate bot response
                setTimeout(() => {
                    chatbotMessages.removeChild(typingIndicator);
                    
                    // Check if user wants to start a workflow
                    if (message.toLowerCase().includes('workflow') || message.toLowerCase().includes('guide me') || message.toLowerCase().includes('step by step')) {
                        startWorkflowSelection(message);
                    } 
                    // Check if user is in interactive mode
                    else if (currentWorkflow) {
                        handleWorkflowInteraction(message);
                    }
                    // Regular response
                    else {
                        const response = generateResponse(message);
                        addMessage(response, 'bot');
                    }
                }, 1500);
            }
            
            // Send message on button click
            chatbotSend.addEventListener('click', sendMessage);
            
            // Send message on Enter key
            chatbotInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
            
            // Add message to chat
            function addMessage(text, sender) {
                const messageElement = document.createElement('div');
                messageElement.classList.add('message', sender);
                messageElement.innerHTML = text;
                chatbotMessages.appendChild(messageElement);
                chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
            }
            
            // Start workflow selection
            function startWorkflowSelection(message) {
                let response = "I can guide you through several molecular genetics workflows. Which one would you like to explore?<br><br>";
                
                Object.keys(workflows).forEach(key => {
                    const workflow = workflows[key];
                    response += `<div class="workflow-step" data-workflow="${key}">
                        <i class="fas fa-play-circle"></i> ${workflow.name}
                    </div>`;
                });
                
                response += `<br>Or you can ask me specific questions about any topic!`;
                
                addMessage(response, 'bot');
                
                // Add event listeners to workflow steps
                setTimeout(() => {
                    document.querySelectorAll('.workflow-step').forEach(step => {
                        step.addEventListener('click', function() {
                            const workflowKey = this.getAttribute('data-workflow');
                            startWorkflow(workflowKey);
                        });
                    });
                }, 100);
            }
            
            // Start a specific workflow
            function startWorkflow(workflowKey) {
                currentWorkflow = workflowKey;
                workflowStep = 0;
                workflowData = {};
                
                const workflow = workflows[workflowKey];
                
                let response = `Starting <strong>${workflow.name}</strong> workflow:<br>`;
                response += `<em>${workflow.description}</em><br><br>`;
                response += `<div class="workflow-progress">
                    <span>Step ${workflowStep + 1} of ${workflow.steps.length}</span>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${(workflowStep / workflow.steps.length) * 100}%"></div>
                    </div>
                </div>`;
                response += `<div class="interactive-mode">
                    <h4><i class="fas fa-microscope"></i> ${workflow.steps[workflowStep]}</h4>
                    <div class="interactive-options">
                        <div class="interactive-option" data-action="explain">Explain this step</div>
                        <div class="interactive-option" data-action="example">Show me an example</div>
                        <div class="interactive-option" data-action="next">Continue to next step</div>
                    </div>
                </div>`;
                
                addMessage(response, 'bot');
                
                // Add event listeners to interactive options
                setTimeout(() => {
                    document.querySelectorAll('.interactive-option').forEach(option => {
                        option.addEventListener('click', function() {
                            const action = this.getAttribute('data-action');
                            handleInteractiveAction(action);
                        });
                    });
                }, 100);
            }
            
            // Handle interactive actions in workflow
            function handleInteractiveAction(action) {
                const workflow = workflows[currentWorkflow];
                
                if (action === 'explain') {
                    const explanation = getStepExplanation(currentWorkflow, workflowStep);
                    addMessage(explanation, 'bot');
                } 
                else if (action === 'example') {
                    const example = getStepExample(currentWorkflow, workflowStep);
                    addMessage(example, 'bot');
                }
                else if (action === 'next') {
                    workflowStep++;
                    
                    if (workflowStep < workflow.steps.length) {
                        let response = `<div class="workflow-progress">
                            <span>Step ${workflowStep + 1} of ${workflow.steps.length}</span>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${(workflowStep / workflow.steps.length) * 100}%"></div>
                            </div>
                        </div>`;
                        response += `<div class="interactive-mode">
                            <h4><i class="fas fa-microscope"></i> ${workflow.steps[workflowStep]}</h4>
                            <div class="interactive-options">
                                <div class="interactive-option" data-action="explain">Explain this step</div>
                                <div class="interactive-option" data-action="example">Show me an example</div>
                                <div class="interactive-option" data-action="next">Continue to next step</div>
                            </div>
                        </div>`;
                        
                        addMessage(response, 'bot');
                        
                        // Re-add event listeners
                        setTimeout(() => {
                            document.querySelectorAll('.interactive-option').forEach(option => {
                                option.addEventListener('click', function() {
                                    const action = this.getAttribute('data-action');
                                    handleInteractiveAction(action);
                                });
                            });
                        }, 100);
                    } else {
                        // Workflow completed
                        const completionMessage = `<strong>Workflow completed!</strong><br><br>
                        You've successfully completed the ${workflow.name} workflow. 
                        Would you like to:<br><br>
                        <div class="interactive-options">
                            <div class="interactive-option" data-action="restart">Restart this workflow</div>
                            <div class="interactive-option" data-action="new">Start a different workflow</div>
                            <div class="interactive-option" data-action="quiz">Take a quick quiz</div>
                        </div>`;
                        
                        addMessage(completionMessage, 'bot');
                        
                        currentWorkflow = null;
                        
                        // Re-add event listeners
                        setTimeout(() => {
                            document.querySelectorAll('.interactive-option').forEach(option => {
                                option.addEventListener('click', function() {
                                    const action = this.getAttribute('data-action');
                                    if (action === 'restart') {
                                        startWorkflow(currentWorkflow);
                                    } else if (action === 'new') {
                                        startWorkflowSelection('new workflow');
                                    } else if (action === 'quiz') {
                                        startQuiz(workflow.name);
                                    }
                                });
                            });
                        }, 100);
                    }
                }
            }
            
            // Handle workflow interaction
            function handleWorkflowInteraction(message) {
                // For now, just provide a generic response
                const response = `I see you're following the ${workflows[currentWorkflow].name} workflow. 
                You can use the interactive options to explore each step in detail, or type "exit workflow" to return to regular chat.`;
                addMessage(response, 'bot');
                
                if (message.toLowerCase().includes('exit workflow')) {
                    currentWorkflow = null;
                    addMessage("Exited workflow mode. How can I help you now?", 'bot');
                }
            }
            
            // Get step explanation
            function getStepExplanation(workflowKey, stepIndex) {
                const explanations = {
                    dnaReplication: [
                        "Initiation begins at specific DNA sequences called origins of replication. In E. coli, this is the oriC region containing repeated sequences that initiator proteins recognize and bind to.",
                        "Helicase enzymes unwind the DNA double helix, breaking hydrogen bonds between base pairs. Single-strand binding proteins stabilize the separated strands, preventing them from reannealing.",
                        "Primase synthesizes short RNA primers (10-12 nucleotides) that provide a 3' OH group for DNA polymerase to begin synthesis. These primers are complementary to the template strand.",
                        "DNA polymerase III adds nucleotides to the 3' end of the primer, synthesizing DNA in the 5'→3' direction. The leading strand is synthesized continuously, while the lagging strand is synthesized in Okazaki fragments.",
                        "DNA polymerase I removes RNA primers and replaces them with DNA. The proofreading function (3'→5' exonuclease activity) corrects errors during synthesis, maintaining high fidelity.",
                        "DNA ligase joins the Okazaki fragments on the lagging strand by catalyzing phosphodiester bond formation. This completes the synthesis of two identical DNA molecules."
                    ],
                    proteinSynthesis: [
                        "Transcription begins when RNA polymerase binds to promoter regions on DNA. The enzyme unwinds the DNA and synthesizes mRNA complementary to the template strand.",
                        "In eukaryotes, the primary transcript undergoes processing: 5' capping with 7-methylguanosine, 3' polyadenylation, and splicing to remove introns and join exons.",
                        "Processed mRNA is exported from the nucleus through nuclear pore complexes. This requires specific export factors that recognize the mature mRNA structure.",
                        "The small ribosomal subunit binds to the 5' end of mRNA and scans until it finds the AUG start codon. The initiator tRNA carrying methionine binds, followed by the large subunit.",
                        "The ribosome moves along mRNA, matching tRNA anticodons to mRNA codons. Peptide bonds form between amino acids, extending the polypeptide chain in the N→C direction.",
                        "When a stop codon (UAA, UAG, or UGA) enters the A site, release factors bind, causing hydrolysis of the polypeptide from the tRNA and dissociation of the ribosomal subunits."
                    ],
                    geneRegulation: [
                        "RNA polymerase recognizes promoter sequences (TATA box in eukaryotes, -10 and -35 regions in bacteria). Transcription factors help position the polymerase correctly.",
                        "Specific transcription factors bind to enhancer or silencer elements, either activating or repressing transcription. These can be tissue-specific or responsive to signals.",
                        "In eukaryotes, chromatin remodeling complexes alter nucleosome positioning, making DNA more or less accessible. Histone modifications (acetylation, methylation) regulate this process.",
                        "After initiation, the polymerase clears the promoter and begins elongation. P-TEFb and other factors regulate the transition and rate of transcription.",
                        "Various factors can pause or accelerate the elongating polymerase. NELF and DSIF cause pausing, while TFIIS can rescue backtracked polymerases.",
                        "Termination signals (poly-A signals in eukaryotes, Rho-dependent or independent in bacteria) trigger release of the transcript and polymerase from DNA."
                    ]
                };
                
                return explanations[workflowKey][stepIndex];
            }
            
            // Get step example
            function getStepExample(workflowKey, stepIndex) {
                const examples = {
                    dnaReplication: [
                        "Example: In E. coli, DnaA proteins bind to 9-mer repeats in the oriC region, causing DNA bending and strand separation at the 13-mer repeats.",
                        "Example: Helicase (DnaB in E. coli) uses ATP hydrolysis to move along DNA at ~1000 nucleotides/second, creating replication forks.",
                        "Example: Primase synthesizes RNA primers ~10 nucleotides long. On the lagging strand, a new primer is needed for each Okazaki fragment.",
                        "Example: DNA polymerase III adds nucleotides at ~1000 bases/second with high accuracy (error rate ~1 in 10^7). The sliding clamp (β subunit) keeps it attached.",
                        "Example: DNA polymerase I removes primers with its 5'→3' exonuclease activity and fills gaps with its polymerase activity.",
                        "Example: DNA ligase uses ATP (in eukaryotes) or NAD+ (in bacteria) to activate the 5' phosphate, enabling bond formation between fragments."
                    ],
                    proteinSynthesis: [
                        "Example: In bacteria, σ factor helps RNA polymerase recognize the -10 (TATAAT) and -35 (TTGACA) promoter sequences.",
                        "Example: The SRP (signal recognition particle) binds to signal sequences on secreted proteins during translation, pausing synthesis until docking with the ER.",
                        "Example: Nuclear export receptor TAP/p15 binds to mRNA and facilitates transport through nuclear pores into the cytoplasm.",
                        "Example: In eukaryotes, eIF2 brings the initiator tRNA to the P site, while eIF4 factors help recruit the ribosome to the 5' cap.",
                        "Example: EF-Tu in bacteria delivers aminoacyl-tRNA to the A site, with GTP hydrolysis ensuring correct codon-anticodon pairing.",
                        "Example: RF1 recognizes UAA and UAG stop codons, while RF2 recognizes UAA and UGA. Both stimulate peptidyl transferase to release the polypeptide."
                    ],
                    geneRegulation: [
                        "Example: The lac operon promoter has -10 and -35 regions where RNA polymerase binds, with CAP-cAMP complex enhancing binding when glucose is low.",
                        "Example: In the lac operon, the lac repressor binds to the operator, blocking transcription when lactose is absent.",
                        "Example: Histone acetyltransferases (HATs) add acetyl groups to lysines, neutralizing positive charge and loosening DNA-histone interactions.",
                        "Example: TFIIH phosphorylates the CTD of RNA polymerase II, facilitating promoter clearance and transition to elongation.",
                        "Example: In the HIV genome, Tat protein binds TAR RNA element and recruits P-TEFb to overcome transcriptional pausing.",
                        "Example: Rho factor in bacteria uses ATP hydrolysis to translocate along mRNA and dissociate the transcription complex at specific sites."
                    ]
                };
                
                return examples[workflowKey][stepIndex];
            }
            
            // Start a quiz
            function startQuiz(topic) {
                const quizzes = {
                    "DNA Replication": [
                        {
                            question: "Which enzyme unwinds the DNA double helix during replication?",
                            options: ["DNA polymerase", "Helicase", "Ligase", "Primase"],
                            answer: 1
                        },
                        {
                            question: "What is the function of single-strand binding proteins?",
                            options: ["Synthesize RNA primers", "Prevent reannealing of DNA strands", "Join Okazaki fragments", "Proofread DNA synthesis"],
                            answer: 1
                        },
                        {
                            question: "Which strand is synthesized continuously?",
                            options: ["Lagging strand", "Template strand", "Leading strand", "Coding strand"],
                            answer: 2
                        }
                    ],
                    "Protein Synthesis": [
                        {
                            question: "Where does transcription occur in eukaryotic cells?",
                            options: ["Cytoplasm", "Nucleus", "Ribosome", "Mitochondria"],
                            answer: 1
                        },
                        {
                            question: "What is the start codon for protein synthesis?",
                            options: ["UAA", "AUG", "UAG", "UGA"],
                            answer: 1
                        },
                        {
                            question: "Which RNA type carries amino acids to the ribosome?",
                            options: ["mRNA", "rRNA", "tRNA", "snRNA"],
                            answer: 2
                        }
                    ],
                    "Gene Regulation": [
                        {
                            question: "What binds to the operator region in the lac operon?",
                            options: ["RNA polymerase", "CAP protein", "Lac repressor", "cAMP"],
                            answer: 2
                        },
                        {
                            question: "Which modification typically activates gene expression?",
                            options: ["Histone methylation", "Histone acetylation", "DNA methylation", "Chromatin condensation"],
                            answer: 1
                        },
                        {
                            question: "What is the function of enhancer elements?",
                            options: ["Bind RNA polymerase", "Increase transcription", "Terminate transcription", "Remove introns"],
                            answer: 1
                        }
                    ]
                };
                
                const quiz = quizzes[topic] || quizzes["DNA Replication"];
                let response = `<strong>Quick Quiz: ${topic}</strong><br><br>`;
                
                quiz.forEach((q, index) => {
                    response += `<div class="interactive-mode">
                        <h4>Question ${index + 1}: ${q.question}</h4>
                        <div class="interactive-options">`;
                    
                    q.options.forEach((option, optIndex) => {
                        response += `<div class="interactive-option" data-question="${index}" data-answer="${optIndex}">${option}</div>`;
                    });
                    
                    response += `</div></div>`;
                });
                
                addMessage(response, 'bot');
                
                // Add event listeners to quiz options
                setTimeout(() => {
                    document.querySelectorAll('.interactive-option[data-question]').forEach(option => {
                        option.addEventListener('click', function() {
                            const questionIndex = parseInt(this.getAttribute('data-question'));
                            const answerIndex = parseInt(this.getAttribute('data-answer'));
                            const correctAnswer = quiz[questionIndex].answer;
                            
                            if (answerIndex === correctAnswer) {
                                addMessage(`<span style="color: var(--success)">✓ Correct! Well done.</span>`, 'bot');
                            } else {
                                addMessage(`<span style="color: var(--error)">✗ Not quite. The correct answer is: ${quiz[questionIndex].options[correctAnswer]}</span>`, 'bot');
                            }
                        });
                    });
                }, 100);
            }
            
            // Enhanced response generation with PDF knowledge
            function generateResponse(message) {
                const lowerMessage = message.toLowerCase();
                
                // DNA structure responses
                if (lowerMessage.includes('dna') && (lowerMessage.includes('structure') || lowerMessage.includes('helix') || lowerMessage.includes('double helix'))) {
                    return `DNA has a <strong>double-helical structure</strong> with two antiparallel polynucleotide chains. Key features:<br><br>
                    • The backbone consists of sugar-phosphate groups<br>
                    • Bases project inward and form hydrogen bonds<br>
                    • <span class="highlight">Adenine (A)</span> pairs with <span class="highlight">Thymine (T)</span> via 2 hydrogen bonds<br>
                    • <span class="highlight">Guanine (G)</span> pairs with <span class="highlight">Cytosine (C)</span> via 3 hydrogen bonds<br>
                    • The two chains have anti-parallel polarity (5'→3' and 3'→5')<br>
                    • The helix is right-handed with a pitch of 3.4 nm<br>
                    • There are roughly 10 base pairs per turn<br>
                    • Base stacking provides additional stability to the structure<br><br>
                    This structure was proposed by Watson and Crick in 1953 based on X-ray diffraction data from Wilkins and Franklin.`;
                }
                
                // DNA replication
                if (lowerMessage.includes('dna replication') || lowerMessage.includes('replication') || lowerMessage.includes('semiconservative')) {
                    return `DNA replication is <strong>semiconservative</strong>, meaning each new DNA molecule contains one original strand and one newly synthesized strand. Key aspects:<br><br>
                    • Proposed by Watson and Crick in 1953<br>
                    • Proven by Meselson and Stahl in 1958 using <sup>15</sup>N and <sup>14</sup>N isotopes<br>
                    • Main enzyme: DNA-dependent DNA polymerase<br>
                    • Replication occurs at replication forks<br>
                    • Leading strand is synthesized continuously (5'→3')<br>
                    • Lagging strand is synthesized discontinuously as Okazaki fragments<br>
                    • DNA ligase joins the fragments<br>
                    • Requires origin of replication to initiate<br>
                    • Highly accurate with error rate of ~1 in 10<sup>9</sup> bases<br>
                    • E. coli completes replication in ~18 minutes at ~2000 bp/second`;
                }
                
                // Transcription
                if (lowerMessage.includes('transcription') || lowerMessage.includes('rna polymerase') || lowerMessage.includes('mrna')) {
                    return `Transcription is the process of copying genetic information from DNA to RNA. Key points:<br><br>
                    <strong>Process:</strong><br>
                    • Only one DNA strand (template strand) is transcribed<br>
                    • RNA polymerase catalyzes RNA synthesis (5'→3')<br>
                    • Promoter region initiates transcription<br>
                    • Terminator region ends transcription<br>
                    • In bacteria: single RNA polymerase with σ factor for initiation<br>
                    • In eukaryotes: three RNA polymerases (I, II, III)<br><br>
                    <strong>Transcription Unit:</strong><br>
                    • Promoter: Binding site for RNA polymerase<br>
                    • Structural gene: Region to be transcribed<br>
                    • Terminator: Signals end of transcription<br><br>
                    <strong>Eukaryotic differences:</strong><br>
                    • Primary transcript (hnRNA) contains introns and exons<br>
                    • Splicing removes introns and joins exons<br>
                    • 5' capping with methyl guanosine triphosphate<br>
                    • 3' poly-A tailing with adenylate residues`;
                }
                
                // Genetic code
                if (lowerMessage.includes('genetic code') || lowerMessage.includes('codon') || lowerMessage.includes('amino acid')) {
                    return `The <strong>genetic code</strong> is the set of rules by which information in mRNA is translated into proteins. Key characteristics:<br><br>
                    • The code is <strong>triplet</strong> - three nucleotides code for one amino acid<br>
                    • 61 codons code for amino acids, 3 are stop codons<br>
                    • The code is <strong>degenerate</strong> - most amino acids have multiple codons<br>
                    • Codons are read continuously without punctuation<br>
                    • The code is nearly <strong>universal</strong> across organisms<br>
                    • <span class="start-codon">AUG</span> codes for Methionine and serves as the start codon<br>
                    • <span class="stop-codon">UAA, UAG, UGA</span> are stop codons<br><br>
                    The genetic code was deciphered through work by Khorana, Nirenberg, and others using synthetic RNA and cell-free systems.`;
                }
                
                // Translation
                if (lowerMessage.includes('translation') || lowerMessage.includes('protein synthesis') || lowerMessage.includes('ribosome')) {
                    return `Translation is the process of protein synthesis from mRNA. Key components and steps:<br><br>
                    <strong>Components:</strong><br>
                    • mRNA: Provides the template with codons<br>
                    • tRNA: Adapter molecule with anticodon and amino acid binding site<br>
                    • Ribosome: Site of protein synthesis with large and small subunits<br>
                    • Aminoacyl-tRNA synthetase: Enzymes that charge tRNA with amino acids<br><br>
                    <strong>Process:</strong><br>
                    • Initiation: Ribosome binds to start codon (AUG)<br>
                    • Elongation: Amino acids added one by one to growing polypeptide<br>
                    • Termination: Stop codon signals release of completed protein<br>
                    • Ribosomal RNA (rRNA) acts as ribozyme for peptide bond formation<br><br>
                    Translation requires energy from GTP and occurs in the 5'→3' direction on mRNA.`;
                }
                
                // Lac operon
                if (lowerMessage.includes('lac operon') || lowerMessage.includes('operon') || lowerMessage.includes('gene regulation')) {
                    return `The <strong>lac operon</strong> is a classic example of gene regulation in bacteria. Key features:<br><br>
                    <strong>Components:</strong><br>
                    • Regulatory gene (i): Codes for repressor protein<br>
                    • Promoter (P): Binding site for RNA polymerase<br>
                    • Operator (O): Binding site for repressor<br>
                    • Structural genes:<br>
                    &nbsp;&nbsp;- z gene: β-galactosidase (hydrolyzes lactose)<br>
                    &nbsp;&nbsp;- y gene: Permease (lactose transport)<br>
                    &nbsp;&nbsp;- a gene: Transacetylase<br><br>
                    <strong>Regulation:</strong><br>
                    • In absence of lactose: Repressor binds operator, preventing transcription<br>
                    • In presence of lactose: Lactose (inducer) binds repressor, inactivating it<br>
                    • RNA polymerase can then transcribe the operon<br>
                    • This is an example of <strong>negative regulation</strong><br><br>
                    The lac operon was elucidated by Jacob and Monod, demonstrating how genes can be regulated by environmental conditions.`;
                }
                
                // Workflow suggestion
                if (lowerMessage.includes('workflow') || lowerMessage.includes('guide') || lowerMessage.includes('step by step') || lowerMessage.includes('tutorial')) {
                    return `I can guide you through interactive workflows on key molecular genetics processes. Would you like to explore:<br><br>
                    <div class="workflow-controls">
                        <div class="workflow-step" data-workflow="dnaReplication">
                            <i class="fas fa-dna"></i> DNA Replication
                        </div>
                        <div class="workflow-step" data-workflow="proteinSynthesis">
                            <i class="fas fa-link"></i> Protein Synthesis
                        </div>
                        <div class="workflow-step" data-workflow="geneRegulation">
                            <i class="fas fa-sliders-h"></i> Gene Regulation
                        </div>
                    </div>
                    <br>Click on any workflow to start, or ask me a specific question!`;
                }
                
                // Default response
                return `I'm MolGenoBot, your molecular genetics assistant! I can explain:<br><br>
                • DNA structure and the double helix<br>
                • DNA replication (semiconservative model)<br>
                • Transcription and RNA processing<br>
                • The genetic code and codon usage<br>
                • Translation and protein synthesis<br>
                • Gene regulation (like the lac operon)<br>
                • Mutations and their effects<br>
                • The Human Genome Project<br>
                • DNA fingerprinting techniques<br>
                • The RNA world hypothesis<br><br>
                I can also guide you through <strong>interactive workflows</strong> on these topics. Just ask for a "workflow" or "step-by-step guide"!`;
            }
            
            // Suggested questions
            document.querySelectorAll('.suggested-question').forEach(question => {
                question.addEventListener('click', () => {
                    chatbotInput.value = question.textContent;
                    sendMessage();
                });
            });
            
            // Add event listeners for workflow controls in regular responses
            setTimeout(() => {
                document.querySelectorAll('.workflow-step').forEach(step => {
                    step.addEventListener('click', function() {
                        const workflowKey = this.getAttribute('data-workflow');
                        startWorkflow(workflowKey);
                    });
                });
            }, 100);
        }

        document.addEventListener('DOMContentLoaded', function() {
            createNetworkBackground();
            initializeChatbot();
            
            // DOM Elements
            const strandType = document.getElementById('strand-type');
            const strandDirection = document.getElementById('strand-direction');
            const templateInfo = document.getElementById('template-info');
            const codingInfo = document.getElementById('coding-info');
            const sequenceLabel = document.getElementById('sequence-label');
            const complementaryLabel = document.getElementById('complementary-label');
            
            const translateBtn = document.getElementById('translate-btn');
            const clearBtn = document.getElementById('clear-btn');
            const dnaInput = document.getElementById('dna-sequence');
            const complementaryStrand = document.getElementById('complementary-strand');
            const mRNA = document.getElementById('mrna-sequence');
            const polypeptide = document.getElementById('polypeptide-chain');
            const molecularWeight = document.getElementById('molecular-weight');
            const baseCount = document.getElementById('base-count');
            const notification = document.getElementById('notification');
            const proteinInfo = document.getElementById('protein-info');
            
            // Genetic code mapping
            const geneticCode = {
                "UUU": "Phe", "UUC": "Phe", "UUA": "Leu", "UUG": "Leu",
                "CUU": "Leu", "CUC": "Leu", "CUA": "Leu", "CUG": "Leu",
                "AUU": "Ile", "AUC": "Ile", "AUA": "Ile", "AUG": "Met",
                "GUU": "Val", "GUC": "Val", "GUA": "Val", "GUG": "Val",
                "UCU": "Ser", "UCC": "Ser", "UCA": "Ser", "UCG": "Ser",
                "CCU": "Pro", "CCC": "Pro", "CCA": "Pro", "CCG": "Pro",
                "ACU": "Thr", "ACC": "Thr", "ACA": "Thr", "ACG": "Thr",
                "GCU": "Ala", "GCC": "Ala", "GCA": "Ala", "GCG": "Ala",
                "UAU": "Tyr", "UAC": "Tyr", "UAA": "STOP", "UAG": "STOP",
                "CAU": "His", "CAC": "His", "CAA": "Gln", "CAG": "Gln",
                "AAU": "Asn", "AAC": "Asn", "AAA": "Lys", "AAG": "Lys",
                "GAU": "Asp", "GAC": "Asp", "GAA": "Glu", "GAG": "Glu",
                "UGU": "Cys", "UGC": "Cys", "UGA": "STOP", "UGG": "Trp",
                "CGU": "Arg", "CGC": "Arg", "CGA": "Arg", "CGG": "Arg",
                "AGU": "Ser", "AGC": "Ser", "AGA": "Arg", "AGG": "Arg",
                "GGU": "Gly", "GGC": "Gly", "GGA": "Gly", "GGG": "Gly"
            };
            
            // Amino acid molecular weights (in Daltons)
            const aminoAcidWeights = {
                "Ala": 89.09, "Arg": 174.20, "Asn": 132.12, "Asp": 133.10,
                "Cys": 121.16, "Gln": 146.15, "Glu": 147.13, "Gly": 75.07,
                "His": 155.16, "Ile": 131.17, "Leu": 131.17, "Lys": 146.19,
                "Met": 149.21, "Phe": 165.19, "Pro": 115.13, "Ser": 105.09,
                "Thr": 119.12, "Trp": 204.23, "Tyr": 181.19, "Val": 117.15
            };
            
            // Update strand info display
            function updateStrandInfo() {
                if (strandType.value === 'template') {
                    templateInfo.classList.remove('hidden');
                    codingInfo.classList.add('hidden');
                    sequenceLabel.innerHTML = '<i class="fas fa-dna"></i> Enter Template Strand:';
                    complementaryLabel.textContent = 'Coding Strand (5\'→3\')';
                } else {
                    templateInfo.classList.add('hidden');
                    codingInfo.classList.remove('hidden');
                    sequenceLabel.innerHTML = '<i class="fas fa-dna"></i> Enter Coding Strand:';
                    complementaryLabel.textContent = 'Template Strand (3\'→5\')';
                }
            }
            
            // Show notification
            function showNotification(message, type = 'success') {
                notification.textContent = message;
                notification.className = `notification ${type} show`;
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }
            
            // Function to get complementary DNA strand
            function getComplementaryStrand(sequence) {
                const complementMap = { 'A': 'T', 'T': 'A', 'C': 'G', 'G': 'C' };
                return sequence.split('').map(base => complementMap[base]).join('');
            }
            
            // Function to reverse a sequence
            function reverseSequence(sequence) {
                return sequence.split('').reverse().join('');
            }
            
            // Function to transcribe DNA to mRNA
            function transcribeToMRNA(sequence) {
                const transcriptionMap = { 'A': 'U', 'T': 'A', 'C': 'G', 'G': 'C' };
                return sequence.split('').map(base => transcriptionMap[base]).join('');
            }
            
            // Function to translate mRNA to polypeptide
            function translateToPolypeptide(mRNA) {
                let polypeptide = [];
                
                // Split mRNA into codons (groups of 3 nucleotides)
                for (let i = 0; i < mRNA.length; i += 3) {
                    const codon = mRNA.substring(i, i + 3);
                    
                    // Stop translation if we encounter a stop codon
                    if (codon.length < 3) break;
                    
                    const aminoAcid = geneticCode[codon];
                    if (aminoAcid === "STOP") {
                        polypeptide.push("STOP");
                        break;
                    }
                    
                    polypeptide.push(aminoAcid);
                }
                
                return polypeptide;
            }
            
            // Function to calculate molecular weight of polypeptide
            function calculateMolecularWeight(aminoAcids) {
                // Remove STOP codon if present
                const filteredAminoAcids = aminoAcids.filter(aa => aa !== "STOP");
                
                if (filteredAminoAcids.length === 0) return 0;
                
                // Calculate total weight of amino acids
                let totalWeight = 0;
                for (const aa of filteredAminoAcids) {
                    totalWeight += aminoAcidWeights[aa];
                }
                
                // Subtract water loss from peptide bond formation (18.015 Da per bond)
                // Number of bonds = number of amino acids - 1
                const waterLoss = 18.015 * (filteredAminoAcids.length - 1);
                
                return totalWeight - waterLoss;
            }
            
            // Update visualization
            function updateVisualization(seq, proteinArray) {
                const dnaVisualization = document.getElementById('dna-visualization');
                const mRNAVisualization = document.getElementById('mrna-visualization');
                const proteinVisualization = document.getElementById('protein-visualization');
                
                // Clear previous visualization
                dnaVisualization.innerHTML = '';
                mRNAVisualization.innerHTML = '';
                proteinVisualization.innerHTML = '';
                
                if (!seq) {
                    // Add placeholders if no sequence
                    dnaVisualization.innerHTML = '<div class="placeholder">Enter sequence</div>';
                    mRNAVisualization.innerHTML = '<div class="placeholder">Transcription</div>';
                    proteinVisualization.innerHTML = '<div class="placeholder">Translation</div>';
                    proteinInfo.textContent = 'Peptide length: 0';
                    return;
                }
                
                // Create DNA visualization (max 4 bases for display on mobile)
                const displaySeq = seq.substring(0, window.innerWidth < 768 ? 4 : 6);
                for (let i = 0; i < displaySeq.length; i++) {
                    const base = displaySeq[i];
                    const baseEl = document.createElement('div');
                    baseEl.className = `base ${base.toLowerCase()}`;
                    baseEl.textContent = base;
                    dnaVisualization.appendChild(baseEl);
                    
                    if (i < displaySeq.length - 1) {
                        const bond = document.createElement('div');
                        bond.className = 'bond';
                        dnaVisualization.appendChild(bond);
                    }
                }
                
                // Create mRNA visualization
                const mRNAseq = transcribeToMRNA(displaySeq);
                
                for (let i = 0; i < mRNAseq.length; i++) {
                    const base = mRNAseq[i];
                    const baseEl = document.createElement('div');
                    baseEl.className = `base ${base.toLowerCase()}`;
                    baseEl.textContent = base;
                    mRNAVisualization.appendChild(baseEl);
                    
                    if (i < mRNAseq.length - 1) {
                        const bond = document.createElement('div');
                        bond.className = 'bond';
                        mRNAVisualization.appendChild(bond);
                    }
                }
                
                // Create protein visualization (first 2-3 amino acids)
                const displayProteinCount = window.innerWidth < 768 ? 2 : 3;
                for (let i = 0; i < Math.min(displayProteinCount, proteinArray.length); i++) {
                    const aa = proteinArray[i];
                    const aaEl = document.createElement('div');
                    aaEl.className = 'base';
                    
                    if (aa === "STOP") {
                        aaEl.classList.add('stop-codon');
                        aaEl.textContent = "STP";
                    } else if (aa === "Met" && i === 0) {
                        aaEl.classList.add('start-codon');
                        aaEl.textContent = aa.substring(0, 3);
                    } else {
                        aaEl.textContent = aa.substring(0, 3);
                    }
                    
                    proteinVisualization.appendChild(aaEl);
                    
                    if (i < Math.min(displayProteinCount, proteinArray.length) - 1) {
                        const bond = document.createElement('div');
                        bond.className = 'bond';
                        proteinVisualization.appendChild(bond);
                    }
                }
                
                // Update protein info
                const peptideLength = proteinArray.filter(aa => aa !== "STOP").length;
                proteinInfo.textContent = `Peptide length: ${peptideLength}`;
            }
            
            // Update base counter
            function updateBaseCounter(sequence) {
                baseCount.textContent = sequence.length;
            }
            
            // Event listeners for strand selection
            strandType.addEventListener('change', updateStrandInfo);
            strandDirection.addEventListener('change', function() {
                // Clear results when direction changes
                complementaryStrand.textContent = '-';
                mRNA.textContent = '-';
                polypeptide.textContent = '-';
                molecularWeight.textContent = 'Molecular Weight: -';
                updateVisualization(null, []);
            });
            
            // Initialize strand info
            updateStrandInfo();
            
            // Event listener for real-time input
            dnaInput.addEventListener('input', function() {
                const dnaSequence = dnaInput.value.toUpperCase().trim();
                
                // Only allow valid DNA characters
                if (!/^[ATCG]*$/.test(dnaSequence)) {
                    // Remove invalid characters
                    dnaInput.value = dnaSequence.replace(/[^ATCG]/gi, '');
                }
                
                // Update base counter
                updateBaseCounter(dnaInput.value);
            });
            
            // Clear button functionality
            clearBtn.addEventListener('click', function() {
                dnaInput.value = '';
                complementaryStrand.textContent = '-';
                mRNA.textContent = '-';
                polypeptide.textContent = '-';
                molecularWeight.textContent = 'Molecular Weight: -';
                updateBaseCounter('');
                updateVisualization(null, []);
                showNotification('Cleared all data');
            });
            
            translateBtn.addEventListener('click', function() {
                const dnaSequence = dnaInput.value.toUpperCase().trim();
                
                // Show loading state
                const originalText = translateBtn.innerHTML;
                translateBtn.innerHTML = '<div class="loading"></div> Translating...';
                translateBtn.disabled = true;
                
                // Reset previous results
                complementaryStrand.textContent = '-';
                mRNA.textContent = '-';
                polypeptide.textContent = '-';
                molecularWeight.textContent = 'Molecular Weight: -';
                
                // Validate input
                if (!dnaSequence) {
                    showNotification('Please enter a DNA sequence.', 'error');
                    translateBtn.innerHTML = originalText;
                    translateBtn.disabled = false;
                    return;
                }
                
                if (!/^[ATCG]+$/.test(dnaSequence)) {
                    showNotification('DNA sequence can only contain A, T, C, or G.', 'error');
                    translateBtn.innerHTML = originalText;
                    translateBtn.disabled = false;
                    return;
                }
                
                // Simulate processing delay for better UX
                setTimeout(() => {
                    let templateStrand, codingStrand, mRNAseq;
                    
                    // Process based on selected strand type and direction
                    if (strandType.value === 'template') {
                        // User entered template strand
                        if (strandDirection.value === '3to5') {
                            // Template strand is 3'→5', which is the standard
                            templateStrand = dnaSequence;
                            codingStrand = getComplementaryStrand(dnaSequence);
                        } else {
                            // Template strand is 5'→3', need to reverse
                            templateStrand = reverseSequence(dnaSequence);
                            codingStrand = getComplementaryStrand(templateStrand);
                        }
                    } else {
                        // User entered coding strand
                        if (strandDirection.value === '5to3') {
                            // Coding strand is 5'→3', which is the standard
                            codingStrand = dnaSequence;
                            templateStrand = getComplementaryStrand(dnaSequence);
                        } else {
                            // Coding strand is 3'→5', need to reverse
                            codingStrand = reverseSequence(dnaSequence);
                            templateStrand = getComplementaryStrand(codingStrand);
                        }
                    }
                    
                    // Transcribe to mRNA (5' to 3') using template strand
                    mRNAseq = transcribeToMRNA(templateStrand);
                    
                    // Translate to polypeptide chain
                    const proteinArray = translateToPolypeptide(mRNAseq);
                    const proteinString = proteinArray.join('-');
                    
                    // Calculate molecular weight
                    const weight = calculateMolecularWeight(proteinArray);
                    
                    // Update results
                    complementaryStrand.textContent = strandType.value === 'template' ? codingStrand : templateStrand;
                    mRNA.textContent = mRNAseq;
                    polypeptide.textContent = proteinString;
                    molecularWeight.textContent = `Molecular Weight: ${weight.toFixed(2)} Da`;
                    
                    // Update visualization
                    updateVisualization(dnaSequence, proteinArray);
                    
                    // Reset button
                    translateBtn.innerHTML = originalText;
                    translateBtn.disabled = false;
                    
                    showNotification('Translation completed successfully!');
                }, 800);
            });
            
            // Initialize with empty visualization
            updateVisualization(null, []);
        });
    </script>
</body>
</html>
