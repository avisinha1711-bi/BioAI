<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GenefloAI Genetic Translator</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        
        :root {
            --primary: #2563eb;
            --primary-light: #3b82f6;
            --primary-dark: #1d4ed8;
            --secondary: #7c3aed;
            --accent: #06b6d4;
            --bg-dark: #0a0f1a;
            --bg-card: #1a2235;
            --text-light: #f8fafc;
            --text-lighter: #cbd5e1;
            --text-muted: #94a3b8;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --border: #2d3748;
        }
        
        body {
            background-color: var(--bg-dark);
            color: var(--text-light);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }
        
        /* Network lines background - Increased visibility */
        .network-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.08; /* Increased from 0.03 */
        }
        
        .network-dot {
            position: absolute;
            width: 3px; /* Increased from 2px */
            height: 3px; /* Increased from 2px */
            background: white;
            border-radius: 50%;
        }
        
        .network-line {
            position: absolute;
            background: white;
            height: 1px;
            transform-origin: left center;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }
        
        header {
            text-align: center;
            padding: 40px 0 30px;
            color: white;
            position: relative;
        }
        
        header h1 {
            font-size: 2.8rem;
            margin-bottom: 12px;
            color: var(--text-light);
            font-weight: 700;
            letter-spacing: -0.5px;
        }
        
        header p {
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
            color: var(--text-muted);
            font-weight: 400;
        }
        
        .card {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            transition: all 0.3s ease;
            border: 1px solid var(--border);
            position: relative;
            overflow: hidden;
        }
        
        .card:hover {
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
        }
        
        .input-section {
            display: flex;
            flex-direction: column;
        }
        
        .input-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        label {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--text-lighter);
            font-size: 1.1rem;
        }
        
        .sequence-counter {
            background: rgba(37, 99, 235, 0.1);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            color: var(--primary-light);
            font-weight: 500;
        }
        
        .input-group {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        input {
            flex: 1;
            padding: 16px 20px;
            background: rgba(26, 34, 53, 0.7);
            border: 1px solid var(--border);
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
            color: var(--text-light);
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
        }
        
        input:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        
        .input-actions {
            display: flex;
            gap: 12px;
        }
        
        button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 14px 24px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        button:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }
        
        button.secondary {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-lighter);
        }
        
        button.secondary:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--primary-light);
        }
        
        .complementary-preview {
            background: rgba(26, 34, 53, 0.7);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 4px solid var(--primary);
            display: none;
            animation: fadeIn 0.5s ease;
            position: relative;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .complementary-preview.show {
            display: block;
        }
        
        .complementary-preview-title {
            font-weight: 600;
            color: var(--text-lighter);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
        }
        
        .complementary-preview-content {
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
            background: rgba(45, 55, 72, 0.5);
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 1rem;
            color: var(--text-light);
            border: 1px solid var(--border);
        }
        
        .results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }
        
        .result-box {
            background: rgba(26, 34, 53, 0.7);
            padding: 25px;
            border-radius: 12px;
            border-left: 4px solid var(--primary);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            border: 1px solid var(--border);
        }
        
        .result-box:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .result-title {
            font-weight: 600;
            color: var(--text-lighter);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1rem;
        }
        
        .result-content {
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
            background: rgba(45, 55, 72, 0.5);
            padding: 18px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 1rem;
            color: var(--text-light);
            min-height: 60px;
            display: flex;
            align-items: center;
            border: 1px solid var(--border);
        }
        
        .visualization {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 40px 0;
            padding: 30px;
            background: var(--bg-card);
            border-radius: 16px;
            border: 1px solid var(--border);
            position: relative;
        }
        
        .process-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            flex: 1;
        }
        
        .step-icon {
            width: 60px;
            height: 60px;
            background: rgba(37, 99, 235, 0.1);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            font-size: 1.5rem;
            color: var(--primary);
            border: 1px solid var(--border);
        }
        
        .step-label {
            font-weight: 600;
            color: var(--text-lighter);
            margin-bottom: 10px;
            font-size: 0.9rem;
        }
        
        .dna-strand {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            min-height: 150px;
            justify-content: center;
        }
        
        .base {
            width: 35px;
            height: 35px;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 8px;
            font-weight: 600;
            color: white;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .base:hover {
            transform: scale(1.05);
        }
        
        .a { background: #ef4444; }
        .t { background: #10b981; }
        .c { background: #f59e0b; color: #1e293b; }
        .g { background: #3b82f6; }
        .u { background: #8b5cf6; }
        
        .bond {
            width: 2px;
            height: 18px;
            background: var(--primary);
            opacity: 0.4;
        }
        
        .arrow {
            font-size: 1.5rem;
            color: var(--primary);
            margin: 0 15px;
            opacity: 0.7;
        }
        
        .protein-info {
            margin-top: 10px;
            font-size: 0.8rem;
            color: var(--text-muted);
            background: rgba(37, 99, 235, 0.1);
            padding: 5px 10px;
            border-radius: 10px;
        }
        
        .info-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px;
            margin-top: 40px;
        }
        
        .info-card {
            background: var(--bg-card);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid var(--border);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .info-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .info-card h3 {
            color: var(--text-lighter);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.2rem;
        }
        
        .info-card ul {
            list-style: none;
        }
        
        .info-card li {
            margin-bottom: 12px;
            padding-left: 30px;
            position: relative;
            color: var(--text-muted);
        }
        
        .info-card li:before {
            content: "•";
            color: var(--primary);
            font-weight: bold;
            position: absolute;
            left: 15px;
            font-size: 1.2rem;
        }
        
        footer {
            text-align: center;
            margin-top: 60px;
            color: var(--text-muted);
            padding: 30px;
            opacity: 0.8;
            border-top: 1px solid var(--border);
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .input-group {
                flex-direction: column;
            }
            
            .input-actions {
                width: 100%;
            }
            
            .input-actions button {
                flex: 1;
            }
            
            .visualization {
                flex-direction: column;
                gap: 30px;
                padding: 20px;
            }
            
            .arrow {
                transform: rotate(90deg);
                margin: 10px 0;
            }
            
            header h1 {
                font-size: 2.2rem;
            }
            
            .process-step {
                width: 100%;
            }
            
            .dna-strand {
                flex-direction: row;
                min-height: auto;
                gap: 10px;
            }
            
            .bond {
                width: 15px;
                height: 2px;
            }
        }
        
        .highlight {
            background: rgba(245, 158, 11, 0.1);
            padding: 3px 6px;
            border-radius: 4px;
            color: #f59e0b;
        }
        
        .stop-codon {
            background: #ef4444;
            color: white;
            padding: 3px 6px;
            border-radius: 4px;
        }
        
        .start-codon {
            background: #10b981;
            padding: 3px 6px;
            border-radius: 4px;
            color: white;
        }
        
        .molecular-weight {
            margin-top: 15px;
            padding: 12px;
            background: rgba(37, 99, 235, 0.1);
            border-radius: 8px;
            font-weight: 600;
            color: var(--text-lighter);
            border-left: 3px solid var(--primary);
        }
        
        .placeholder {
            color: var(--text-muted);
            font-style: italic;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 10px;
            color: white;
            font-weight: 600;
            z-index: 1000;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transform: translateX(150%);
            transition: transform 0.4s ease;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.success {
            background: var(--success);
        }
        
        .notification.error {
            background: var(--error);
        }
        
        .loading {
            display: inline-block;
            width: 18px;
            height: 18px;
            border: 2px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* New styles for strand selection */
        .strand-selection {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .strand-options {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .strand-option {
            flex: 1;
            min-width: 200px;
        }
        
        .strand-option label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-lighter);
        }
        
        select {
            width: 100%;
            padding: 14px 16px;
            background: rgba(26, 34, 53, 0.7);
            border: 1px solid var(--border);
            border-radius: 10px;
            font-size: 16px;
            color: var(--text-light);
            transition: all 0.3s;
        }
        
        select:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        
        .strand-info {
            background: rgba(37, 99, 235, 0.1);
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid var(--primary);
            margin-top: 10px;
            font-size: 0.9rem;
            color: var(--text-lighter);
        }
        
        .strand-info.hidden {
            display: none;
        }

        /* Chatbot Styles - Improved sizing and positioning */
        .chatbot-container {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 100;
        }

        .chatbot-toggle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            transition: all 0.3s;
        }

        .chatbot-toggle:hover {
            background: var(--primary-dark);
            transform: scale(1.05);
        }

        .chatbot-window {
            position: absolute;
            bottom: 80px;
            right: 0;
            width: 380px;
            height: 520px;
            background: var(--bg-card);
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            border: 1px solid var(--border);
            transform: scale(0);
            transform-origin: bottom right;
            transition: transform 0.3s;
            max-height: calc(100vh - 150px);
            max-width: calc(100vw - 60px);
        }

        .chatbot-window.active {
            transform: scale(1);
        }

        .chatbot-header {
            padding: 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chatbot-header h3 {
            color: var(--text-lighter);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chatbot-close {
            background: none;
            border: none;
            color: var(--text-muted);
            font-size: 1.2rem;
            cursor: pointer;
            padding: 5px;
        }

        .chatbot-close:hover {
            color: var(--text-light);
        }

        .chatbot-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 12px;
            line-height: 1.4;
        }

        .message.user {
            align-self: flex-end;
            background: var(--primary);
            color: white;
            border-bottom-right-radius: 4px;
        }

        .message.bot {
            align-self: flex-start;
            background: rgba(26, 34, 53, 0.7);
            color: var(--text-light);
            border: 1px solid var(--border);
            border-bottom-left-radius: 4px;
        }

        .chatbot-input {
            padding: 20px;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 10px;
        }

        .chatbot-input input {
            flex: 1;
            padding: 12px 16px;
        }

        .chatbot-input button {
            padding: 12px 16px;
        }

        .suggested-questions {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }

        .suggested-question {
            background: rgba(37, 99, 235, 0.1);
            color: var(--primary-light);
            border: 1px solid var(--border);
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .suggested-question:hover {
            background: rgba(37, 99, 235, 0.2);
        }

        @media (max-width: 768px) {
            .chatbot-window {
                width: 90vw;
                right: 5vw;
            }
        }

        @media (max-height: 700px) {
            .chatbot-window {
                height: 450px;
            }
        }
    </style>
</head>
<body>
    <!-- Network lines background - More visible -->
    <div class="network-background" id="network-background"></div>
    
    <div class="container">
        <header>
            <h1>GenefloAI Genetic Translator</h1>
            <p>Translate DNA sequences to mRNA and polypeptide chains using advanced algorithms</p>
        </header>
        
        <!-- Strand Selection Card -->
        <div class="card">
            <div class="strand-selection">
                <div class="strand-options">
                    <div class="strand-option">
                        <label for="strand-type"><i class="fas fa-dna"></i> Strand Type</label>
                        <select id="strand-type">
                            <option value="template">Template Strand</option>
                            <option value="coding">Coding Strand</option>
                        </select>
                    </div>
                    
                    <div class="strand-option">
                        <label for="strand-direction"><i class="fas fa-arrows-alt-h"></i> Direction</label>
                        <select id="strand-direction">
                            <option value="3to5">3' → 5'</option>
                            <option value="5to3">5' → 3'</option>
                        </select>
                    </div>
                </div>
                
                <div class="strand-info" id="template-info">
                    <strong>Template Strand:</strong> Serves as the template for mRNA synthesis during transcription. 
                    The mRNA sequence is complementary to the template strand.
                </div>
                
                <div class="strand-info hidden" id="coding-info">
                    <strong>Coding Strand:</strong> Has the same sequence as the mRNA (with T instead of U). 
                    Also called the sense strand or non-template strand.
                </div>
            </div>
        </div>
        
        <!-- Main Input Card -->
        <div class="card">
            <div class="input-section">
                <div class="input-header">
                    <label for="dna-sequence" id="sequence-label">
                        <i class="fas fa-dna"></i> Enter DNA Sequence:
                    </label>
                    <div class="sequence-counter">
                        <span id="base-count">0</span> bases
                    </div>
                </div>
                
                <div class="input-group">
                    <input type="text" id="dna-sequence" placeholder="e.g., TACGAATTCTAGCATGAC">
                    <div class="input-actions">
                        <button id="translate-btn">
                            <i class="fas fa-code"></i> Translate
                        </button>
                        <button class="secondary" id="clear-btn">
                            <i class="fas fa-eraser"></i> Clear
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="results">
                <div class="result-box">
                    <div class="result-title">
                        <i class="fas fa-exchange-alt"></i> <span id="complementary-label">Coding Strand (5'→3')</span>
                    </div>
                    <div class="result-content" id="complementary-strand">-</div>
                </div>
                
                <div class="result-box">
                    <div class="result-title">
                        <i class="fas fa-rna"></i> mRNA Sequence (5'→3')
                    </div>
                    <div class="result-content" id="mrna-sequence">-</div>
                </div>
                
                <div class="result-box">
                    <div class="result-title">
                        <i class="fas fa-link"></i> Polypeptide Chain
                    </div>
                    <div class="result-content" id="polypeptide-chain">-</div>
                    <div class="molecular-weight" id="molecular-weight">Molecular Weight: -</div>
                </div>
            </div>
        </div>
        
        <div class="visualization">
            <div class="process-step">
                <div class="step-icon">
                    <i class="fas fa-dna"></i>
                </div>
                <div class="step-label">DNA Template</div>
                <div class="dna-strand" id="dna-visualization">
                    <div class="placeholder">Enter sequence</div>
                </div>
            </div>
            
            <div class="arrow">
                <i class="fas fa-arrow-right"></i>
            </div>
            
            <div class="process-step">
                <div class="step-icon">
                    <i class="fas fa-rna"></i>
                </div>
                <div class="step-label">mRNA</div>
                <div class="dna-strand" id="mrna-visualization">
                    <div class="placeholder">Transcription</div>
                </div>
            </div>
            
            <div class="arrow">
                <i class="fas fa-arrow-right"></i>
            </div>
            
            <div class="process-step">
                <div class="step-icon">
                    <i class="fas fa-link"></i>
                </div>
                <div class="step-label">Protein</div>
                <div class="dna-strand" id="protein-visualization">
                    <div class="placeholder">Translation</div>
                </div>
                <div class="protein-info" id="protein-info">Peptide length: 0</div>
            </div>
        </div>
        
        <div class="info-section">
            <div class="info-card">
                <h3><i class="fas fa-dna"></i> Genetic Code</h3>
                <ul>
                    <li><span class="highlight">Adenine (A)</span> pairs with <span class="highlight">Thymine (T)</span> in DNA</li>
                    <li><span class="highlight">Guanine (G)</span> pairs with <span class="highlight">Cytosine (C)</span> in DNA</li>
                    <li>In RNA, <span class="highlight">Thymine (T)</span> is replaced with <span class="highlight">Uracil (U)</span></li>
                    <li><span class="start-codon">AUG</span> is the start codon (Methionine)</li>
                    <li><span class="stop-codon">UAA, UAG, UGA</span> are stop codons</li>
                </ul>
            </div>
            
            <div class="info-card">
                <h3><i class="fas fa-flask"></i> Applications</h3>
                <ul>
                    <li>Genetic research and education</li>
                    <li>Protein synthesis simulation</li>
                    <li>Bioinformatics workflows</li>
                    <li>Molecular biology studies</li>
                    <li>AI-powered genetic analysis</li>
                </ul>
            </div>
            
            <div class="info-card">
                <h3><i class="fas fa-weight"></i> Molecular Weight Calculation</h3>
                <ul>
                    <li>Calculated for the polypeptide chain</li>
                    <li>Accounts for water loss in peptide bonds</li>
                    <li>Based on standard amino acid molecular weights</li>
                    <li>Displayed in Daltons (Da)</li>
                </ul>
            </div>
        </div>
        
        <footer>
            <p>GenefloAI Genetic Translator | Advanced DNA to Protein Conversion Tool</p>
            <p>© 2025 GenefloAI Research</p>
        </footer>
    </div>

    <!-- Chatbot - Now MolGenoBot with enhanced knowledge -->
    <div class="chatbot-container">
        <div class="chatbot-toggle" id="chatbot-toggle">
            <i class="fas fa-robot"></i>
        </div>
        <div class="chatbot-window" id="chatbot-window">
            <div class="chatbot-header">
                <h3><i class="fas fa-robot"></i> MolGenoBot</h3>
                <button class="chatbot-close" id="chatbot-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="chatbot-messages" id="chatbot-messages">
                <div class="message bot">
                    Hello! I'm MolGenoBot, your molecular genetics assistant. I've been trained on the latest research including "Human Molecular Genetics and Genomics — Important Advances and Exciting Possibilities" by Collins, Doudna, Lander, and Rotimi. I can explain DNA structure, transcription, translation, genetic regulation, CRISPR technology, genomic diversity, and more. How can I assist you today?
                    <div class="suggested-questions">
                        <div class="suggested-question">Explain CRISPR-Cas9</div>
                        <div class="suggested-question">What are polygenic risk scores?</div>
                        <div class="suggested-question">Tell me about genomic diversity</div>
                        <div class="suggested-question">What is the Human Genome Project?</div>
                    </div>
                </div>
            </div>
            <div class="chatbot-input">
                <input type="text" id="chatbot-input" placeholder="Ask about molecular genetics...">
                <button id="chatbot-send"><i class="fas fa-paper-plane"></i></button>
            </div>
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <script>
        // Create network background with more visibility
        function createNetworkBackground() {
            const container = document.getElementById('network-background');
            const dots = [];
            const lines = [];
            
            // Create more dots for better visibility
            for (let i = 0; i < 60; i++) { // Increased from 40
                const dot = document.createElement('div');
                dot.className = 'network-dot';
                dot.style.left = `${Math.random() * 100}%`;
                dot.style.top = `${Math.random() * 100}%`;
                container.appendChild(dot);
                dots.push(dot);
            }
            
            // Create lines between nearby dots
            for (let i = 0; i < dots.length; i++) {
                for (let j = i + 1; j < dots.length; j++) {
                    const dot1 = dots[i];
                    const dot2 = dots[j];
                    
                    const x1 = parseFloat(dot1.style.left);
                    const y1 = parseFloat(dot1.style.top);
                    const x2 = parseFloat(dot2.style.left);
                    const y2 = parseFloat(dot2.style.top);
                    
                    const distance = Math.sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2);
                    
                    // Connect more dots for better visibility
                    if (distance < 25) { // Increased from 20
                        const line = document.createElement('div');
                        line.className = 'network-line';
                        
                        const length = distance;
                        const angle = Math.atan2(y2 - y1, x2 - x1) * 180 / Math.PI;
                        
                        line.style.width = `${length}%`;
                        line.style.left = `${x1}%`;
                        line.style.top = `${y1}%`;
                        line.style.transform = `rotate(${angle}deg)`;
                        
                        container.appendChild(line);
                        lines.push(line);
                    }
                }
            }
        }

        // Enhanced MolGenoBot functionality with research paper knowledge
        function initializeChatbot() {
            const chatbotToggle = document.getElementById('chatbot-toggle');
            const chatbotWindow = document.getElementById('chatbot-window');
            const chatbotClose = document.getElementById('chatbot-close');
            const chatbotMessages = document.getElementById('chatbot-messages');
            const chatbotInput = document.getElementById('chatbot-input');
            const chatbotSend = document.getElementById('chatbot-send');
            
            // Toggle chatbot window
            chatbotToggle.addEventListener('click', () => {
                chatbotWindow.classList.toggle('active');
            });
            
            // Close chatbot window
            chatbotClose.addEventListener('click', () => {
                chatbotWindow.classList.remove('active');
            });
            
            // Send message
            function sendMessage() {
                const message = chatbotInput.value.trim();
                if (!message) return;
                
                // Add user message
                addMessage(message, 'user');
                chatbotInput.value = '';
                
                // Show typing indicator
                const typingIndicator = document.createElement('div');
                typingIndicator.classList.add('message', 'bot');
                typingIndicator.innerHTML = '<div class="loading" style="display:inline-block; margin-right:10px;"></div> Thinking...';
                chatbotMessages.appendChild(typingIndicator);
                chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
                
                // Generate bot response
                setTimeout(() => {
                    chatbotMessages.removeChild(typingIndicator);
                    const response = generateResponse(message);
                    addMessage(response, 'bot');
                }, 1500);
            }
            
            // Send message on button click
            chatbotSend.addEventListener('click', sendMessage);
            
            // Send message on Enter key
            chatbotInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
            
            // Add message to chat
            function addMessage(text, sender) {
                const messageElement = document.createElement('div');
                messageElement.classList.add('message', sender);
                messageElement.innerHTML = text;
                chatbotMessages.appendChild(messageElement);
                chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
            }
            
            // Suggested questions
            document.querySelectorAll('.suggested-question').forEach(question => {
                question.addEventListener('click', () => {
                    chatbotInput.value = question.textContent;
                    sendMessage();
                });
            });
            
            // Enhanced response generation with research paper knowledge
            function generateResponse(message) {
                const lowerMessage = message.toLowerCase();
                
                // Detect tone and adjust response style
                const tone = detectTone(message);
                
                // CRISPR-Cas9 responses
                if (lowerMessage.includes('crispr') || lowerMessage.includes('cas9') || lowerMessage.includes('gene editing')) {
                    return `${tone.prefix}CRISPR-Cas9 is a revolutionary gene-editing technology derived from bacterial immune systems. As highlighted in the 2021 research by Collins et al., CRISPR-Cas9 emerged around 2012 when Emmanuelle Charpentier and Jennifer Doudna showed it could edit DNA in vitro (earning them the 2020 Nobel Prize in Chemistry).<br><br>
                    <strong>Key advances:</strong><br>
                    • Can create targeted DNA breaks that trigger site-specific DNA repair<br>
                    • Next-generation formats can control gene transcription or alter sequences via base editing without DNA breaks<br>
                    • In 2020, the first patient with sickle cell disease was treated with an ex vivo CRISPR-Cas9 approach<br>
                    • Multiple clinical trials are underway, though long-term safety is still being evaluated<br>
                    • Current applications focus on single-gene disorders where editing can be done ex vivo on appropriate cells${tone.suffix}`;
                }
                
                // Polygenic risk scores
                if (lowerMessage.includes('polygenic risk') || lowerMessage.includes('risk score') || 
                    (lowerMessage.includes('polygenic') && lowerMessage.includes('risk'))) {
                    return `${tone.prefix}Polygenic risk scores are tools that combine information from multiple genetic variants to estimate an individual's genetic predisposition to common diseases. According to recent research:<br><br>
                    <strong>Current status:</strong><br>
                    • Over 100,000 robust associations between genomic regions and common diseases have been identified<br>
                    • These scores can identify patients at increased risk for heart disease, breast cancer, and other conditions<br>
                    • However, additional rigorous testing is needed, including evaluation of clinical outcomes<br>
                    • A major limitation is that most genomic research has involved participants of European ancestry<br>
                    • This lack of diversity raises questions about whether these scores will benefit all populations equally${tone.suffix}`;
                }
                
                // Genomic diversity
                if (lowerMessage.includes('genomic diversity') || lowerMessage.includes('diversity') && 
                    (lowerMessage.includes('genomic') || lowerMessage.includes('genetic'))) {
                    return `${tone.prefix}Genomic diversity refers to the genetic variation across human populations. The research paper highlights critical issues:<br><br>
                    <strong>Key findings:</strong><br>
                    • Despite potential insights, both investigators and participants in genomic research have largely been of European ancestry<br>
                    • This lack of diversity hinders biological understanding and exacerbates health disparities<br>
                    • Studies of diverse populations have revealed population-level differences in disease susceptibility and drug responses<br>
                    • Examples include:<br>
                    &nbsp;&nbsp;- African ancestry-specific APOL1 variants that protect against sleeping sickness but increase kidney failure risk<br>
                    &nbsp;&nbsp;- A risk haplotype for type 2 diabetes in SLC16A11 common in Indigenous peoples of the Americas<br>
                    &nbsp;&nbsp;- PCSK9 loss-of-function mutations more common in people of African ancestry, reducing cholesterol and heart disease risk<br>
                    • Initiatives like H3Africa are working to increase participation from underrepresented populations${tone.suffix}`;
                }
                
                // Human Genome Project
                if (lowerMessage.includes('human genome project') || lowerMessage.includes('hgp')) {
                    return `${tone.prefix}The Human Genome Project (HGP) was a landmark international research effort to sequence the entire human genome. Key milestones from the research:<br><br>
                    <strong>Project timeline:</strong><br>
                    • 1990: NIH and Department of Energy launched the HGP<br>
                    • 1994: Human genetic mapping goals met<br>
                    • 1995: Human physical mapping goals met<br>
                    • 1997: "Bermuda principles" established rapid, public release of genome data<br>
                    • 2001: First draft of human genome sequence published by HGP consortium and Celera Genomics<br>
                    • 2003: HGP completed more than 2 years ahead of schedule<br><br>
                    <strong>Impact:</strong><br>
                    • DNA sequencing throughput increased from 1,000 base pairs per day to over 1,000 per second<br>
                    • Cost of sequencing dropped from $3 billion during HGP to about $600 today<br>
                    • Enabled discovery of genes for over 5,000 rare Mendelian diseases<br>
                    • Paved the way for personalized medicine and genomic research${tone.suffix}`;
                }
                
                // Single-cell sequencing
                if (lowerMessage.includes('single-cell') || lowerMessage.includes('single cell') || 
                    (lowerMessage.includes('rna') && lowerMessage.includes('sequencing'))) {
                    return `${tone.prefix}Single-cell RNA sequencing represents a major advancement in genomics research. According to the latest findings:<br><br>
                    <strong>Recent developments:</strong><br>
                    • Genomics research has moved beyond analyzing DNA variation to studying gene expression in individual cells<br>
                    • Driven by new methods for single-cell RNA sequencing and chromatin analysis<br>
                    • Tens of millions of cells have been characterized en route to a complete cell atlas of the human body<br>
                    • This effort is revealing hundreds of new cell types<br>
                    • Characterizing how cell types differ between healthy people and those with various diseases<br>
                    • Provides unprecedented resolution for understanding cellular heterogeneity and disease mechanisms${tone.suffix}`;
                }
                
                // Biobanks and large-scale genomics
                if (lowerMessage.includes('biobank') || lowerMessage.includes('all of us') || 
                    lowerMessage.includes('uk biobank') || lowerMessage.includes('large-scale genomic')) {
                    return `${tone.prefix}Large-scale biobanks are revolutionizing genomic research. Key initiatives mentioned in the research:<br><br>
                    <strong>Major projects:</strong><br>
                    • <strong>UK Biobank:</strong> Contains genetic and health data from half a million participants<br>
                    • <strong>All of Us Research Program:</strong> NIH initiative enrolling over 1 million participants contributing genetic, health, and environmental data<br>
                    • <strong>Cancer Genome Atlas (TCGA):</strong> Molecularly characterized over 20,000 samples across 33 cancer types<br>
                    • <strong>International HapMap Project:</strong> Gathers data on human genetic variation to speed gene discovery<br><br>
                    <strong>Goals:</strong><br>
                    • Create comprehensive resources linking genomic information with medical records<br>
                    • Enable powerful explorations rather than hypothesis-limited research<br>
                    • Ultimately integrate genomic information into routine medical care${tone.suffix}`;
                }
                
                // Gene therapy
                if (lowerMessage.includes('gene therapy') || (lowerMessage.includes('gene') && 
                    lowerMessage.includes('therapy')) || lowerMessage.includes('molecularly targeted')) {
                    return `${tone.prefix}Gene therapy represents a promising approach for treating genetic disorders. Recent advances include:<br><br>
                    <strong>Success stories:</strong><br>
                    • Safe and effective molecularly targeted drugs now available for 90% of people with cystic fibrosis<br>
                    • Dramatic successes for spinal muscular atrophy and hemophilia<br>
                    • For some Mendelian disorders, targeted drugs have been developed using detailed pathophysiology understanding<br><br>
                    <strong>Challenges:</strong><br>
                    • Developing and validating treatments has been more challenging than diagnosis<br>
                    • The traditional approach can take decades and doesn't scale well to thousands of genetic disorders<br>
                    • Precisely targeted genome-editing technologies now provide new therapeutic avenues${tone.suffix}`;
                }
                
                // DNA Structure responses
                if (lowerMessage.includes('dna') && (lowerMessage.includes('structure') || lowerMessage.includes('helix'))) {
                    return `${tone.prefix}DNA has a double-helical structure with two antiparallel strands. The backbone consists of deoxyribose sugars connected by phosphodiester bonds. Bases (A, T, C, G) pair specifically: A-T with 2 hydrogen bonds and G-C with 3 hydrogen bonds. DNA exists in different helical forms (A, B, C) with B-form being most common in cells. The structure allows for information storage and precise replication.${tone.suffix}`;
                }
                
                if (lowerMessage.includes('central dogma')) {
                    return `${tone.prefix}The Central Dogma describes the flow of genetic information: DNA → RNA → Protein. DNA is transcribed to mRNA, which is then translated into proteins. This process ensures genetic information is accurately passed from genes to functional proteins. It's a fundamental principle in molecular biology.${tone.suffix}`;
                }
                
                if (lowerMessage.includes('rna polymerase') || lowerMessage.includes('transcription')) {
                    return `${tone.prefix}RNA polymerase is the enzyme that synthesizes RNA from a DNA template. E. coli has one RNA polymerase with multiple subunits (β, β', α, σ), while eukaryotes have three types (I, II, III). Transcription involves initiation (polymerase binding to promoter), elongation (RNA synthesis), and termination. The σ subunit helps recognize promoters, and different σ factors allow transcription of different gene classes.${tone.suffix}`;
                }
                
                if (lowerMessage.includes('translation') || lowerMessage.includes('protein synthesis')) {
                    return `${tone.prefix}Translation converts mRNA into proteins using ribosomes. It involves initiation (ribosome assembly on mRNA), elongation (amino acid addition), and termination (protein release). Transfer RNA (tRNA) brings amino acids to the ribosome, where they're added to the growing polypeptide chain. The genetic code is read in triplets (codons), with AUG as start and UAA/UAG/UGA as stop codons.${tone.suffix}`;
                }
                
                // Ethical considerations
                if (lowerMessage.includes('ethical') || lowerMessage.includes('privacy') || 
                    lowerMessage.includes('heritable') || lowerMessage.includes('equitable')) {
                    return `${tone.prefix}Ethical considerations in genomics are increasingly important. The research highlights several key questions:<br><br>
                    <strong>Critical issues:</strong><br>
                    • How do we ensure equitable and inclusive access to research opportunities and therapeutic benefits?<br>
                    • How do we balance scientific progress with emerging ethical issues?<br>
                    • Questions regarding the use of genome-editing technologies for heritable genetic changes<br>
                    • How do we sustain data-sharing ethos while protecting participant privacy and respecting cultural norms?<br><br>
                    These questions underscore why oversight bodies like the National Academy of Medicine will be crucial in the coming decades.${tone.suffix}`;
                }
                
                // Default response with research context
                return `${tone.prefix}I'm MolGenoBot, trained on the latest molecular genetics research including "Human Molecular Genetics and Genomics — Important Advances and Exciting Possibilities." I can explain DNA structure, replication, transcription, translation, gene regulation, mutations, CRISPR technology, genomic diversity, polygenic risk scores, single-cell sequencing, biobanks, gene therapy, and ethical considerations in genomics. Could you please ask about one of these specific topics or rephrase your question?${tone.suffix}`;
            }
            
            // Detect tone from user message
            function detectTone(message) {
                const lowerMessage = message.toLowerCase();
                
                // Check for excited/enthusiastic tone
                if (lowerMessage.includes('!') || lowerMessage.includes('amazing') || 
                    lowerMessage.includes('wow') || lowerMessage.includes('awesome') ||
                    lowerMessage.includes('love') || lowerMessage.includes('great')) {
                    return {
                        prefix: "Wow, exciting question! ",
                        suffix: " Isn't molecular genetics fascinating?"
                    };
                }
                
                // Check for confused/uncertain tone
                if (lowerMessage.includes('?') && (lowerMessage.includes('confused') || 
                    lowerMessage.includes('not sure') || lowerMessage.includes('help') ||
                    lowerMessage.includes('understand') || lowerMessage.includes('what') ||
                    lowerMessage.includes('how') || lowerMessage.includes('why'))) {
                    return {
                        prefix: "I'd be happy to clarify that for you! ",
                        suffix: " Does that help clear things up?"
                    };
                }
                
                // Check for formal/academic tone
                if (lowerMessage.includes('please') || lowerMessage.includes('could you') || 
                    lowerMessage.includes('would you') || lowerMessage.includes('explain') ||
                    lowerMessage.length > 50) {
                    return {
                        prefix: "Certainly. ",
                        suffix: " Let me know if you need further details."
                    };
                }
                
                // Check for casual/friendly tone
                if (lowerMessage.includes('hey') || lowerMessage.includes('hi') || 
                    lowerMessage.includes('hello') || lowerMessage.includes('thanks') ||
                    lowerMessage.includes('thank you') || lowerMessage.includes('cool') ||
                    lowerMessage.includes('nice')) {
                    return {
                        prefix: "Hey there! ",
                        suffix: " Hope that helps!"
                    };
                }
                
                // Default neutral tone
                return {
                    prefix: "",
                    suffix: ""
                };
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            createNetworkBackground();
            initializeChatbot();
            
            // DOM Elements
            const strandType = document.getElementById('strand-type');
            const strandDirection = document.getElementById('strand-direction');
            const templateInfo = document.getElementById('template-info');
            const codingInfo = document.getElementById('coding-info');
            const sequenceLabel = document.getElementById('sequence-label');
            const complementaryLabel = document.getElementById('complementary-label');
            
            const translateBtn = document.getElementById('translate-btn');
            const clearBtn = document.getElementById('clear-btn');
            const dnaInput = document.getElementById('dna-sequence');
            const complementaryStrand = document.getElementById('complementary-strand');
            const mRNA = document.getElementById('mrna-sequence');
            const polypeptide = document.getElementById('polypeptide-chain');
            const molecularWeight = document.getElementById('molecular-weight');
            const baseCount = document.getElementById('base-count');
            const notification = document.getElementById('notification');
            const proteinInfo = document.getElementById('protein-info');
            
            // Genetic code mapping
            const geneticCode = {
                "UUU": "Phe", "UUC": "Phe", "UUA": "Leu", "UUG": "Leu",
                "CUU": "Leu", "CUC": "Leu", "CUA": "Leu", "CUG": "Leu",
                "AUU": "Ile", "AUC": "Ile", "AUA": "Ile", "AUG": "Met",
                "GUU": "Val", "GUC": "Val", "GUA": "Val", "GUG": "Val",
                "UCU": "Ser", "UCC": "Ser", "UCA": "Ser", "UCG": "Ser",
                "CCU": "Pro", "CCC": "Pro", "CCA": "Pro", "CCG": "Pro",
                "ACU": "Thr", "ACC": "Thr", "ACA": "Thr", "ACG": "Thr",
                "GCU": "Ala", "GCC": "Ala", "GCA": "Ala", "GCG": "Ala",
                "UAU": "Tyr", "UAC": "Tyr", "UAA": "STOP", "UAG": "STOP",
                "CAU": "His", "CAC": "His", "CAA": "Gln", "CAG": "Gln",
                "AAU": "Asn", "AAC": "Asn", "AAA": "Lys", "AAG": "Lys",
                "GAU": "Asp", "GAC": "Asp", "GAA": "Glu", "GAG": "Glu",
                "UGU": "Cys", "UGC": "Cys", "UGA": "STOP", "UGG": "Trp",
                "CGU": "Arg", "CGC": "Arg", "CGA": "Arg", "CGG": "Arg",
                "AGU": "Ser", "AGC": "Ser", "AGA": "Arg", "AGG": "Arg",
                "GGU": "Gly", "GGC": "Gly", "GGA": "Gly", "GGG": "Gly"
            };
            
            // Amino acid molecular weights (in Daltons)
            const aminoAcidWeights = {
                "Ala": 89.09, "Arg": 174.20, "Asn": 132.12, "Asp": 133.10,
                "Cys": 121.16, "Gln": 146.15, "Glu": 147.13, "Gly": 75.07,
                "His": 155.16, "Ile": 131.17, "Leu": 131.17, "Lys": 146.19,
                "Met": 149.21, "Phe": 165.19, "Pro": 115.13, "Ser": 105.09,
                "Thr": 119.12, "Trp": 204.23, "Tyr": 181.19, "Val": 117.15
            };
            
            // Update strand info display
            function updateStrandInfo() {
                if (strandType.value === 'template') {
                    templateInfo.classList.remove('hidden');
                    codingInfo.classList.add('hidden');
                    sequenceLabel.innerHTML = '<i class="fas fa-dna"></i> Enter Template Strand:';
                    complementaryLabel.textContent = 'Coding Strand (5\'→3\')';
                } else {
                    templateInfo.classList.add('hidden');
                    codingInfo.classList.remove('hidden');
                    sequenceLabel.innerHTML = '<i class="fas fa-dna"></i> Enter Coding Strand:';
                    complementaryLabel.textContent = 'Template Strand (3\'→5\')';
                }
            }
            
            // Show notification
            function showNotification(message, type = 'success') {
                notification.textContent = message;
                notification.className = `notification ${type} show`;
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }
            
            // Function to get complementary DNA strand
            function getComplementaryStrand(sequence) {
                const complementMap = { 'A': 'T', 'T': 'A', 'C': 'G', 'G': 'C' };
                return sequence.split('').map(base => complementMap[base]).join('');
            }
            
            // Function to reverse a sequence
            function reverseSequence(sequence) {
                return sequence.split('').reverse().join('');
            }
            
            // Function to transcribe DNA to mRNA
            function transcribeToMRNA(sequence) {
                const transcriptionMap = { 'A': 'U', 'T': 'A', 'C': 'G', 'G': 'C' };
                return sequence.split('').map(base => transcriptionMap[base]).join('');
            }
            
            // Function to translate mRNA to polypeptide
            function translateToPolypeptide(mRNA) {
                let polypeptide = [];
                
                // Split mRNA into codons (groups of 3 nucleotides)
                for (let i = 0; i < mRNA.length; i += 3) {
                    const codon = mRNA.substring(i, i + 3);
                    
                    // Stop translation if we encounter a stop codon
                    if (codon.length < 3) break;
                    
                    const aminoAcid = geneticCode[codon];
                    if (aminoAcid === "STOP") {
                        polypeptide.push("STOP");
                        break;
                    }
                    
                    polypeptide.push(aminoAcid);
                }
                
                return polypeptide;
            }
            
            // Function to calculate molecular weight of polypeptide
            function calculateMolecularWeight(aminoAcids) {
                // Remove STOP codon if present
                const filteredAminoAcids = aminoAcids.filter(aa => aa !== "STOP");
                
                if (filteredAminoAcids.length === 0) return 0;
                
                // Calculate total weight of amino acids
                let totalWeight = 0;
                for (const aa of filteredAminoAcids) {
                    totalWeight += aminoAcidWeights[aa];
                }
                
                // Subtract water loss from peptide bond formation (18.015 Da per bond)
                // Number of bonds = number of amino acids - 1
                const waterLoss = 18.015 * (filteredAminoAcids.length - 1);
                
                return totalWeight - waterLoss;
            }
            
            // Update visualization
            function updateVisualization(seq, proteinArray) {
                const dnaVisualization = document.getElementById('dna-visualization');
                const mRNAVisualization = document.getElementById('mrna-visualization');
                const proteinVisualization = document.getElementById('protein-visualization');
                
                // Clear previous visualization
                dnaVisualization.innerHTML = '';
                mRNAVisualization.innerHTML = '';
                proteinVisualization.innerHTML = '';
                
                if (!seq) {
                    // Add placeholders if no sequence
                    dnaVisualization.innerHTML = '<div class="placeholder">Enter sequence</div>';
                    mRNAVisualization.innerHTML = '<div class="placeholder">Transcription</div>';
                    proteinVisualization.innerHTML = '<div class="placeholder">Translation</div>';
                    proteinInfo.textContent = 'Peptide length: 0';
                    return;
                }
                
                // Create DNA visualization (max 4 bases for display on mobile)
                const displaySeq = seq.substring(0, window.innerWidth < 768 ? 4 : 6);
                for (let i = 0; i < displaySeq.length; i++) {
                    const base = displaySeq[i];
                    const baseEl = document.createElement('div');
                    baseEl.className = `base ${base.toLowerCase()}`;
                    baseEl.textContent = base;
                    dnaVisualization.appendChild(baseEl);
                    
                    if (i < displaySeq.length - 1) {
                        const bond = document.createElement('div');
                        bond.className = 'bond';
                        dnaVisualization.appendChild(bond);
                    }
                }
                
                // Create mRNA visualization
                const mRNAseq = transcribeToMRNA(displaySeq);
                
                for (let i = 0; i < mRNAseq.length; i++) {
                    const base = mRNAseq[i];
                    const baseEl = document.createElement('div');
                    baseEl.className = `base ${base.toLowerCase()}`;
                    baseEl.textContent = base;
                    mRNAVisualization.appendChild(baseEl);
                    
                    if (i < mRNAseq.length - 1) {
                        const bond = document.createElement('div');
                        bond.className = 'bond';
                        mRNAVisualization.appendChild(bond);
                    }
                }
                
                // Create protein visualization (first 2-3 amino acids)
                const displayProteinCount = window.innerWidth < 768 ? 2 : 3;
                for (let i = 0; i < Math.min(displayProteinCount, proteinArray.length); i++) {
                    const aa = proteinArray[i];
                    const aaEl = document.createElement('div');
                    aaEl.className = 'base';
                    
                    if (aa === "STOP") {
                        aaEl.classList.add('stop-codon');
                        aaEl.textContent = "STP";
                    } else if (aa === "Met" && i === 0) {
                        aaEl.classList.add('start-codon');
                        aaEl.textContent = aa.substring(0, 3);
                    } else {
                        aaEl.textContent = aa.substring(0, 3);
                    }
                    
                    proteinVisualization.appendChild(aaEl);
                    
                    if (i < Math.min(displayProteinCount, proteinArray.length) - 1) {
                        const bond = document.createElement('div');
                        bond.className = 'bond';
                        proteinVisualization.appendChild(bond);
                    }
                }
                
                // Update protein info
                const peptideLength = proteinArray.filter(aa => aa !== "STOP").length;
                proteinInfo.textContent = `Peptide length: ${peptideLength}`;
            }
            
            // Update base counter
            function updateBaseCounter(sequence) {
                baseCount.textContent = sequence.length;
            }
            
            // Event listeners for strand selection
            strandType.addEventListener('change', updateStrandInfo);
            strandDirection.addEventListener('change', function() {
                // Clear results when direction changes
                complementaryStrand.textContent = '-';
                mRNA.textContent = '-';
                polypeptide.textContent = '-';
                molecularWeight.textContent = 'Molecular Weight: -';
                updateVisualization(null, []);
            });
            
            // Initialize strand info
            updateStrandInfo();
            
            // Event listener for real-time input
            dnaInput.addEventListener('input', function() {
                const dnaSequence = dnaInput.value.toUpperCase().trim();
                
                // Only allow valid DNA characters
                if (!/^[ATCG]*$/.test(dnaSequence)) {
                    // Remove invalid characters
                    dnaInput.value = dnaSequence.replace(/[^ATCG]/gi, '');
                }
                
                // Update base counter
                updateBaseCounter(dnaInput.value);
            });
            
            // Clear button functionality
            clearBtn.addEventListener('click', function() {
                dnaInput.value = '';
                complementaryStrand.textContent = '-';
                mRNA.textContent = '-';
                polypeptide.textContent = '-';
                molecularWeight.textContent = 'Molecular Weight: -';
                updateBaseCounter('');
                updateVisualization(null, []);
                showNotification('Cleared all data');
            });
            
            translateBtn.addEventListener('click', function() {
                const dnaSequence = dnaInput.value.toUpperCase().trim();
                
                // Show loading state
                const originalText = translateBtn.innerHTML;
                translateBtn.innerHTML = '<div class="loading"></div> Translating...';
                translateBtn.disabled = true;
                
                // Reset previous results
                complementaryStrand.textContent = '-';
                mRNA.textContent = '-';
                polypeptide.textContent = '-';
                molecularWeight.textContent = 'Molecular Weight: -';
                
                // Validate input
                if (!dnaSequence) {
                    showNotification('Please enter a DNA sequence.', 'error');
                    translateBtn.innerHTML = originalText;
                    translateBtn.disabled = false;
                    return;
                }
                
                if (!/^[ATCG]+$/.test(dnaSequence)) {
                    showNotification('DNA sequence can only contain A, T, C, or G.', 'error');
                    translateBtn.innerHTML = originalText;
                    translateBtn.disabled = false;
                    return;
                }
                
                // Simulate processing delay for better UX
                setTimeout(() => {
                    let templateStrand, codingStrand, mRNAseq;
                    
                    // Process based on selected strand type and direction
                    if (strandType.value === 'template') {
                        // User entered template strand
                        if (strandDirection.value === '3to5') {
                            // Template strand is 3'→5', which is the standard
                            templateStrand = dnaSequence;
                            codingStrand = getComplementaryStrand(dnaSequence);
                        } else {
                            // Template strand is 5'→3', need to reverse
                            templateStrand = reverseSequence(dnaSequence);
                            codingStrand = getComplementaryStrand(templateStrand);
                        }
                    } else {
                        // User entered coding strand
                        if (strandDirection.value === '5to3') {
                            // Coding strand is 5'→3', which is the standard
                            codingStrand = dnaSequence;
                            templateStrand = getComplementaryStrand(dnaSequence);
                        } else {
                            // Coding strand is 3'→5', need to reverse
                            codingStrand = reverseSequence(dnaSequence);
                            templateStrand = getComplementaryStrand(codingStrand);
                        }
                    }
                    
                    // Transcribe to mRNA (5' to 3') using template strand
                    mRNAseq = transcribeToMRNA(templateStrand);
                    
                    // Translate to polypeptide chain
                    const proteinArray = translateToPolypeptide(mRNAseq);
                    const proteinString = proteinArray.join('-');
                    
                    // Calculate molecular weight
                    const weight = calculateMolecularWeight(proteinArray);
                    
                    // Update results
                    complementaryStrand.textContent = strandType.value === 'template' ? codingStrand : templateStrand;
                    mRNA.textContent = mRNAseq;
                    polypeptide.textContent = proteinString;
                    molecularWeight.textContent = `Molecular Weight: ${weight.toFixed(2)} Da`;
                    
                    // Update visualization
                    updateVisualization(dnaSequence, proteinArray);
                    
                    // Reset button
                    translateBtn.innerHTML = originalText;
                    translateBtn.disabled = false;
                    
                    showNotification('Translation completed successfully!');
                }, 800);
            });
            
            // Initialize with empty visualization
            updateVisualization(null, []);
        });
    </script>
</body>
</html>
